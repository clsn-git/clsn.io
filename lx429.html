<html><!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no"><meta http-equiv="Cache-Control" content="no-transform" /><meta http-equiv="Cache-Control" content="no-siteapp" /><title>Nginxçš„åå‘ä»£ç†ä¸è´Ÿè½½å‡è¡¡ | æƒ¨ç»¿å°‘å¹´</title><meta name="description" content="ã€€ã€€ç®€å•åœ°è¯´ï¼Œé›†ç¾¤å°±æ˜¯æŒ‡ä¸€ç»„ï¼ˆè‹¥å¹²ä¸ªï¼‰ç›¸äº’ç‹¬ç«‹çš„è®¡ç®—æœºï¼Œåˆ©ç”¨é«˜é€Ÿé€šä¿¡ç½‘ç»œç»„æˆçš„ä¸€ä¸ªè¾ƒå¤§çš„è®¡ç®—æœºæœåŠ¡ç³»ç»Ÿï¼Œæ¯ä¸ªé›†ç¾¤èŠ‚ç‚¹ï¼ˆå³é›†ç¾¤ä¸­çš„æ¯å°è®¡ç®—æœºï¼‰éƒ½æ˜¯è¿è¡Œå„è‡ªæœåŠ¡çš„ç‹¬ç«‹æœå™¨ã€‚è¿™äº›æœåŠ¡å™¨ä¹‹é—´å¯ä»¥å½¼æ­¤é€šä¿¡ï¼ŒååŒå‘ç”¨æˆ·æä¾›åº”ç”¨ç¨‹åºã€ç³»ç»Ÿèµ„æºå’Œæ•°æ®ï¼Œå¹¶ä»¥å•ä¸€ç³»ç»Ÿçš„æ¨¡å¼åŠ ä»¥ç®¡ç†ã€‚å½“ç”¨æˆ·å®¢æˆ·æœºè¯·æ±‚é›†ç¾¤ç³»ç»Ÿæ—¶ï¼Œé›†ç¾¤ç»™ç”¨æˆ·çš„æ„Ÿè§‰å°±æ˜¯ä¸€ä¸ªå•ä¸€ç‹¬ç«‹çš„æœåŠ¡å™¨ï¼Œè€Œå®é™…ä¸Šç”¨æˆ·è¯·æ±‚çš„æ˜¯ä¸€ç»„é›†ç¾¤æœåŠ¡å™¨ã€‚" /><meta name="keywords" content="" /><link rel="shortcut icon" href="Frog-2.png" tppabs="http://clsn.io/wp-content/uploads/2018/09/Frog-2.png"><link rel="apple-touch-icon" sizes="114x114" href="Frog-2.png" tppabs="http://clsn.io/wp-content/uploads/2018/09/Frog-2.png" /><link rel="profile" href="11" tppabs="http://gmpg.org/xfn/11"><link rel="pingback" href="xmlrpc.php" tppabs="http://clsn.io/xmlrpc.php"><!--[if lt IE 9]><script src="/wp-content/themes/clsn-003/js/html5.js"></script><script src="/wp-content/themes/clsn-003/js/css3-mediaqueries.js"></script><![endif]--><link rel='stylesheet' id='begin-style-css' href="style.css-ver=5.2" tppabs="http://clsn.io/wp-content/themes/clsn-003/style.css?ver=5.2" type='text/css' media='all' /><link rel='stylesheet' id='fonts-css' href="fonts.css-ver=2017.07.26" tppabs="http://clsn.io/wp-content/themes/clsn-003/css/fonts/fonts.css?ver=2017.07.26" type='text/css' media='all' /><link rel='stylesheet' id='highlight-css' href="highlight.css-ver=2017.07.26" tppabs="http://clsn.io/wp-content/themes/clsn-003/css/highlight.css?ver=2017.07.26" type='text/css' media='all' /><script type='text/javascript' src="jquery.min.js-ver=1.10.1" tppabs="http://clsn.io/wp-content/themes/clsn-003/js/jquery.min.js?ver=1.10.1"></script><link rel="canonical" href="lx429.html" tppabs="http://clsn.io/clsn/lx429.html" /><link rel="icon" href="Frog-2.png" tppabs="http://clsn.io/wp-content/uploads/2018/09/Frog-2.png" sizes="32x32" /><link rel="icon" href="Frog-2.png" tppabs="http://clsn.io/wp-content/uploads/2018/09/Frog-2.png" sizes="192x192" /><link rel="apple-touch-icon-precomposed" href="Frog-2.png" tppabs="http://clsn.io/wp-content/uploads/2018/09/Frog-2.png" /><meta name="msapplication-TileImage" content="/wp-content/uploads/2018/09/Frog-2.png" /></head><body class="post-template-default single single-post postid-429 single-format-standard"><div id="page" class="hfeed site"> <header id="masthead" class="site-header"> <div id="header-main" class="header-main"> <nav id="top-header"> <div class="top-nav"> <div class="menu-%e8%81%94%e7%b3%bb%e6%96%b9%e5%bc%8f-container"><ul id="menu-%e8%81%94%e7%b3%bb%e6%96%b9%e5%bc%8f" class="top-menu"><li id="menu-item-1268" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1268"><a href="index.htm" tppabs="http://clsn.io/">åšå®¢åœ°å€</a></li><li id="menu-item-1269" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-1269"><a href="javascript:if(confirm('https://shang.qq.com/wpa/qunwpa?idkey=20c5455d6aaf8df9722be043588a9adda7cd9a18b6563744e4143d736559d946  \n\nÎÄ¼ş²¢Î´ÒÀ Teleport Pro È¡»Ø£¬ÒòÎª ´ËÒ»µØÖ·Ê¹ÓÃÉĞÎ´Ö§³ÖµÄĞ­Òé (ÀıÈç£¬gopher)¡£  \n\nÄãÒª´Ó·şÎñÆ÷ÉÏ´ò¿ªËüÂğ£¿'))window.location='https://shang.qq.com/wpa/qunwpa?idkey=20c5455d6aaf8df9722be043588a9adda7cd9a18b6563744e4143d736559d946'" tppabs="https://shang.qq.com/wpa/qunwpa?idkey=20c5455d6aaf8df9722be043588a9adda7cd9a18b6563744e4143d736559d946">Linuxè€å¸æœº</a></li><li id="menu-item-1270" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-1270"><a href="javascript:if(confirm('https://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&  \n\nÎÄ¼ş²¢Î´ÒÀ Teleport Pro È¡»Ø£¬ÒòÎª ´ËÒ»µØÖ·Ê¹ÓÃÉĞÎ´Ö§³ÖµÄĞ­Òé (ÀıÈç£¬gopher)¡£  \n\nÄãÒª´Ó·şÎñÆ÷ÉÏ´ò¿ªËüÂğ£¿'))window.location='https://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&#038;email=clsn@nmtui.com'" tppabs="https://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&#038;email=clsn@nmtui.com">ç»™æˆ‘å‘é‚®ä»¶</a></li></ul></div> </div> </nav><!-- #top-header --> <div id="menu-box"> <div id="top-menu"> <span class="nav-search"></span> <div class="logo-site"> <p class="site-title"> <a href="index.htm" tppabs="http://clsn.io/"><img src="1-1.png" tppabs="http://clsn.io/wp-content/uploads/2018/09/1-1.png" title="æƒ¨ç»¿å°‘å¹´" alt="æƒ¨ç»¿å°‘å¹´" rel="home" /><span class="site-name">æƒ¨ç»¿å°‘å¹´</span></a> </p> </div><!-- .logo-site --> <div id="site-nav-wrap"> <div id="sidr-close"><a href="#sidr-close" class="toggle-sidr-close">Ã—</a></div> <div id="sidr-menu"><div class="toggle-sidr-menu">MENU</a></div></div> <nav id="site-nav" class="main-nav"> <a href="#sidr-main" id="navigation-toggle" class="bars"><i class="be be-menu"></i></a> <div class="menu-%e6%83%a8%e7%bb%bf%e5%b0%91%e5%b9%b4-container"><ul id="menu-%e6%83%a8%e7%bb%bf%e5%b0%91%e5%b9%b4" class="down-menu nav-menu"><li id="menu-item-1053" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-has-children menu-item-1053"><a href="javascript:if(confirm('http://clsn.io/clsn-ops/ops-linux/  \n\nÎÄ¼ş²¢Î´ÒÀ Teleport Pro È¡»Ø£¬ÒòÎª ËüÎŞ·¨È¡µÃ£¬»òÖøËüÈ¡»Øºó·ÅÆú£¬»òÊÇÏîÄ¿Í£Ö¹µÄÌ«¿ì¡£  \n\nÄãÒª´Ó·şÎñÆ÷ÉÏ´ò¿ªËüÂğ£¿'))window.location='http://clsn.io/clsn-ops/ops-linux/'" tppabs="http://clsn.io/clsn-ops/ops-linux/">è¿ç»´åŸºæœ¬åŠŸ</a><ul class="sub-menu"> <li id="menu-item-1054" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1054"><a href="javascript:if(confirm('http://clsn.io/clsn-ops/ops-linux/dev-shell/  \n\nÎÄ¼ş²¢Î´ÒÀ Teleport Pro È¡»Ø£¬ÒòÎª ËüÎŞ·¨È¡µÃ£¬»òÖøËüÈ¡»Øºó·ÅÆú£¬»òÊÇÏîÄ¿Í£Ö¹µÄÌ«¿ì¡£  \n\nÄãÒª´Ó·şÎñÆ÷ÉÏ´ò¿ªËüÂğ£¿'))window.location='http://clsn.io/clsn-ops/ops-linux/dev-shell/'" tppabs="http://clsn.io/clsn-ops/ops-linux/dev-shell/">Shellç¼–ç¨‹</a></li> <li id="menu-item-1055" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-1055"><a href="index-3.htm" tppabs="http://clsn.io/clsn-ops/ops-linux/web-app/">Webåº”ç”¨</a></li> <li id="menu-item-1056" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1056"><a href="index-4.htm" tppabs="http://clsn.io/clsn-ops/ops-linux/monitor/">ç›‘æ§æœåŠ¡</a></li> <li id="menu-item-1057" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1057"><a href="index-5.htm" tppabs="http://clsn.io/clsn-ops/ops-linux/automation/">è‡ªåŠ¨åŒ–</a></li> <li id="menu-item-1058" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1058"><a href="index-6.htm" tppabs="http://clsn.io/clsn-ops/ops-linux/storage/">å­˜å‚¨</a></li> <li id="menu-item-1059" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1059"><a href="javascript:if(confirm('http://clsn.io/clsn-ops/ops-linux/acl/  \n\nÎÄ¼ş²¢Î´ÒÀ Teleport Pro È¡»Ø£¬ÒòÎª ËüÎŞ·¨È¡µÃ£¬»òÖøËüÈ¡»Øºó·ÅÆú£¬»òÊÇÏîÄ¿Í£Ö¹µÄÌ«¿ì¡£  \n\nÄãÒª´Ó·şÎñÆ÷ÉÏ´ò¿ªËüÂğ£¿'))window.location='http://clsn.io/clsn-ops/ops-linux/acl/'" tppabs="http://clsn.io/clsn-ops/ops-linux/acl/">å®‰å…¨</a></li></ul></li><li id="menu-item-1044" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-1044"><a href="index-8.htm" tppabs="http://clsn.io/clsn-ops/cloud/">äº‘è®¡ç®—</a><ul class="sub-menu"> <li id="menu-item-1046" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1046"><a href="javascript:if(confirm('http://clsn.io/clsn-ops/cloud/virt/  \n\nÎÄ¼ş²¢Î´ÒÀ Teleport Pro È¡»Ø£¬ÒòÎª ËüÎŞ·¨È¡µÃ£¬»òÖøËüÈ¡»Øºó·ÅÆú£¬»òÊÇÏîÄ¿Í£Ö¹µÄÌ«¿ì¡£  \n\nÄãÒª´Ó·şÎñÆ÷ÉÏ´ò¿ªËüÂğ£¿'))window.location='http://clsn.io/clsn-ops/cloud/virt/'" tppabs="http://clsn.io/clsn-ops/cloud/virt/">è™šæ‹ŸåŒ–</a></li> <li id="menu-item-1045" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1045"><a href="javascript:if(confirm('http://clsn.io/clsn-ops/cloud/openstack/  \n\nÎÄ¼ş²¢Î´ÒÀ Teleport Pro È¡»Ø£¬ÒòÎª ËüÎŞ·¨È¡µÃ£¬»òÖøËüÈ¡»Øºó·ÅÆú£¬»òÊÇÏîÄ¿Í£Ö¹µÄÌ«¿ì¡£  \n\nÄãÒª´Ó·şÎñÆ÷ÉÏ´ò¿ªËüÂğ£¿'))window.location='http://clsn.io/clsn-ops/cloud/openstack/'" tppabs="http://clsn.io/clsn-ops/cloud/openstack/">OpenStack</a></li></ul></li><li id="menu-item-1048" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-1048"><a href="index-11.htm" tppabs="http://clsn.io/clsn-ops/databases/">æ•°æ®åº“</a><ul class="sub-menu"> <li id="menu-item-1049" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1049"><a href="javascript:if(confirm('http://clsn.io/clsn-ops/databases/mysql/  \n\nÎÄ¼ş²¢Î´ÒÀ Teleport Pro È¡»Ø£¬ÒòÎª ËüÎŞ·¨È¡µÃ£¬»òÖøËüÈ¡»Øºó·ÅÆú£¬»òÊÇÏîÄ¿Í£Ö¹µÄÌ«¿ì¡£  \n\nÄãÒª´Ó·şÎñÆ÷ÉÏ´ò¿ªËüÂğ£¿'))window.location='http://clsn.io/clsn-ops/databases/mysql/'" tppabs="http://clsn.io/clsn-ops/databases/mysql/">MySQL</a></li> <li id="menu-item-1050" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1050"><a href="index-13.htm" tppabs="http://clsn.io/clsn-ops/databases/nosql/">NoSQL</a></li></ul></li><li id="menu-item-1052" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1052"><a href="index-14.htm" tppabs="http://clsn.io/clsn-ops/network/">ç½‘ç»œæŠ€æœ¯</a></li><li id="menu-item-1051" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-1051"><a href="index-15.htm" tppabs="http://clsn.io/clsn-ops/play-linux/">ç©è½¬Linux</a></li><li id="menu-item-1047" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1047"><a href="index-16.htm" tppabs="http://clsn.io/clsn-ops/dev-ops/">æ•æ·å¼€å‘</a></li><li id="menu-item-1258" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1258"><a href="contribute-page.htm" tppabs="http://clsn.io/contribute-page">æŠ•ç¨¿</a></li></ul></div> </nav><!-- #site-nav --> </div><!-- #site-nav-wrap --> <div class="clear"></div> </div><!-- #top-menu --> </div><!-- #menu-box --> </div><!-- #menu-box --></header><!-- #masthead --><div id="search-main"> <div class="searchbar"> <form method="get" id="searchform" action="http://clsn.io/"> <span class="search-input"> <input type="text" value="" name="s" id="s" placeholder="è¾“å…¥æœç´¢å†…å®¹" required /> <button type="submit" id="searchsubmit"><i class="be be-search"></i></button> </span> </form></div> <div class="clear"></div></div> <nav class="breadcrumb"> <a class="crumbs" href="index.htm" tppabs="http://clsn.io/"><i class="be be-home"></i>é¦–é¡µ</a><i class="be be-arrowright"></i><a href="javascript:if(confirm('http://clsn.io/clsn-ops/linux%e8%bf%90%e7%bb%b4/  \n\nÎÄ¼ş²¢Î´ÒÀ Teleport Pro È¡»Ø£¬ÒòÎª ËüÎŞ·¨È¡µÃ£¬»òÖøËüÈ¡»Øºó·ÅÆú£¬»òÊÇÏîÄ¿Í£Ö¹µÄÌ«¿ì¡£  \n\nÄãÒª´Ó·şÎñÆ÷ÉÏ´ò¿ªËüÂğ£¿'))window.location='http://clsn.io/clsn-ops/linux%e8%bf%90%e7%bb%b4/'" tppabs="http://clsn.io/clsn-ops/linux%e8%bf%90%e7%bb%b4/" rel="category tag">Linuxè¿ç»´</a><i class="be be-arrowright"></i><a href="javascript:if(confirm('http://clsn.io/clsn-ops/ops-linux/  \n\nÎÄ¼ş²¢Î´ÒÀ Teleport Pro È¡»Ø£¬ÒòÎª ËüÎŞ·¨È¡µÃ£¬»òÖøËüÈ¡»Øºó·ÅÆú£¬»òÊÇÏîÄ¿Í£Ö¹µÄÌ«¿ì¡£  \n\nÄãÒª´Ó·şÎñÆ÷ÉÏ´ò¿ªËüÂğ£¿'))window.location='http://clsn.io/clsn-ops/ops-linux/'" tppabs="http://clsn.io/clsn-ops/ops-linux/">è¿ç»´åŸºæœ¬åŠŸ</a><i class="be be-arrowright"></i><a href="index-3.htm" tppabs="http://clsn.io/clsn-ops/ops-linux/web-app/" rel="category tag">Webåº”ç”¨</a><i class="be be-arrowright"></i><a href="index-15.htm" tppabs="http://clsn.io/clsn-ops/play-linux/" rel="category tag">ç©è½¬Linux</a><i class="be be-arrowright"></i><a href="javascript:if(confirm('http://clsn.io/clsn-ops/ops-linux/  \n\nÎÄ¼ş²¢Î´ÒÀ Teleport Pro È¡»Ø£¬ÒòÎª ËüÎŞ·¨È¡µÃ£¬»òÖøËüÈ¡»Øºó·ÅÆú£¬»òÊÇÏîÄ¿Í£Ö¹µÄÌ«¿ì¡£  \n\nÄãÒª´Ó·şÎñÆ÷ÉÏ´ò¿ªËüÂğ£¿'))window.location='http://clsn.io/clsn-ops/ops-linux/'" tppabs="http://clsn.io/clsn-ops/ops-linux/" rel="category tag">è¿ç»´åŸºæœ¬åŠŸ</a><i class="be be-arrowright"></i>Nginxçš„åå‘ä»£ç†ä¸è´Ÿè½½å‡è¡¡ </nav> <div id="content" class="site-content"> <div id="primary" class="content-area"> <main id="main" class="site-main" role="main"> <article id="post-429" class="post-429 post type-post status-publish format-standard hentry category-linux category-web-app category-play-linux category-ops-linux ury"> <header class="entry-header"> <h1 class="entry-title">Nginxçš„åå‘ä»£ç†ä¸è´Ÿè½½å‡è¡¡</h1> </header><!-- .entry-header --> <div class="entry-content"> <div class="begin-single-meta"><span class="my-date"><i class="be be-schedule"></i> 2017å¹´12æœˆ17æ—¥<i class="i-time">02:40:00</i></span><span class="comment"><a href="lx429.html#respond" tppabs="http://clsn.io/clsn/lx429.html#respond" rel="external nofollow"><i class="be be-speechbubble"></i> å‘è¡¨è¯„è®º</a></span><span class="print"><a href="javascript:printme()" target="_self" title="æ‰“å°"><i class="be be-print"></i></a></span><span class="s-hide"><a href="#"><span class="off-side"></span></a></span></div> <div class="single-content"> <div class='favorite-box'><span class='favorite-e'><a class='wpzm-link' href="javascript:if(confirm('http://clsn.io/clsn/lx429.html?wpzmaction=add&postid=429  \n\nÎÄ¼ş²¢Î´ÒÀ Teleport Pro È¡»Ø£¬ÒòÎª ËüÎŞ·¨È¡µÃ£¬»òÖøËüÈ¡»Øºó·ÅÆú£¬»òÊÇÏîÄ¿Í£Ö¹µÄÌ«¿ì¡£  \n\nÄãÒª´Ó·şÎñÆ÷ÉÏ´ò¿ªËüÂğ£¿'))window.location='http://clsn.io/clsn/lx429.html?wpzmaction=add&postid=429'" tppabs="http://clsn.io/clsn/lx429.html?wpzmaction=add&postid=429" rel='nofollow'> æ”¶ <i class="be be-favorite"></i> è—</a></span></div> <h2>1.1 é›†ç¾¤æ˜¯ä»€ä¹ˆ</h2>
<p>ã€€ã€€ç®€å•åœ°è¯´ï¼Œé›†ç¾¤å°±æ˜¯æŒ‡ä¸€ç»„ï¼ˆè‹¥å¹²ä¸ªï¼‰ç›¸äº’ç‹¬ç«‹çš„è®¡ç®—æœºï¼Œåˆ©ç”¨é«˜é€Ÿé€šä¿¡ç½‘ç»œç»„æˆçš„ä¸€ä¸ªè¾ƒå¤§çš„è®¡ç®—æœºæœåŠ¡ç³»ç»Ÿï¼Œæ¯ä¸ªé›†ç¾¤èŠ‚ç‚¹ï¼ˆå³é›†ç¾¤ä¸­çš„æ¯å°è®¡ç®—æœºï¼‰éƒ½æ˜¯è¿è¡Œå„è‡ªæœåŠ¡çš„ç‹¬ç«‹æœå™¨ã€‚è¿™äº›æœåŠ¡å™¨ä¹‹é—´å¯ä»¥å½¼æ­¤é€šä¿¡ï¼ŒååŒå‘ç”¨æˆ·æä¾›åº”ç”¨ç¨‹åºã€ç³»ç»Ÿèµ„æºå’Œæ•°æ®ï¼Œå¹¶ä»¥å•ä¸€ç³»ç»Ÿçš„æ¨¡å¼åŠ ä»¥ç®¡ç†ã€‚å½“ç”¨æˆ·å®¢æˆ·æœºè¯·æ±‚é›†ç¾¤ç³»ç»Ÿæ—¶ï¼Œé›†ç¾¤ç»™ç”¨æˆ·çš„æ„Ÿè§‰å°±æ˜¯ä¸€ä¸ªå•ä¸€ç‹¬ç«‹çš„æœåŠ¡å™¨ï¼Œè€Œå®é™…ä¸Šç”¨æˆ·è¯·æ±‚çš„æ˜¯ä¸€ç»„é›†ç¾¤æœåŠ¡å™¨ã€‚</p>
<p>ã€€ã€€æ‰“å¼€è°·æ­Œã€ç™¾åº¦çš„é¡µé¢ï¼Œçœ‹èµ·æ¥å¥½ç®€å•ï¼Œä¹Ÿè®¸ä½ è§‰å¾—ç”¨å‡ åˆ†é’Ÿå°±å¯ä»¥åˆ¶ä½œå‡ºç›¸ä¼¼çš„ç½‘é¡µï¼Œè€Œå®é™…ä¸Šï¼Œè¿™ä¸ªé¡µé¢çš„èƒŒåæ˜¯ç”±æˆåƒä¸Šä¸‡å°æœåŠ¡å™¨é›†ç¾¤ååŒå·¥ä½œçš„ç»“æœã€‚è€Œè¿™ä¹ˆå¤šçš„æœåŠ¡å™¨ç»´æŠ¤å’Œç®¡ç†ï¼Œä»¥åŠç›¸äº’åè°ƒå·¥ä½œä¹Ÿè®¸å°±æ˜¯è¯»è€…ä½ æœªæ¥çš„å·¥ä½œèŒè´£äº†ã€‚</p>
<p>ã€€ã€€è‹¥è¦ç”¨ä¸€å¥è¯æè¿°é›†ç¾¤ï¼Œå³ä¸€å †æœåŠ¡å™¨åˆä½œåšåŒä¸€ä»¶äº‹ï¼Œè¿™äº›æœºå™¨å¯èƒ½éœ€è¦æ•´ä¸ªæŠ€æœ¯å›¢é˜Ÿæ¶æ„ã€è®¾è®¡å’Œç»Ÿä¸€åè°ƒç®¡ç†ï¼Œè¿™äº›æœºå™¨å¯ä»¥åˆ†å¸ƒåœ¨ä¸€ä¸ªæœºæˆ¿ï¼Œä¹Ÿå¯ä»¥åˆ†å¸ƒåœ¨å…¨å›½å…¨çƒå„ä¸ªåœ°åŒºçš„å¤šä¸ªæœºæˆ¿ã€‚</p>
<h2>1.2 ä¸ºä»€ä¹ˆè¦æœ‰é›†ç¾¤</h2>
<div>
<p class="a">ã€€ã€€é«˜æ€§èƒ½ã€ä»·æ ¼æœ‰æ•ˆæ€§ã€å¯ä¼¸ç¼©æ€§ã€é«˜å¯ç”¨æ€§</p>
<p class="a">ã€€ã€€é€æ˜æ€§ã€å¯ç®¡ç†æ€§ã€å¯ç¼–è¾‘æ€§</p>
</div>
<h3>1.2.1 é›†ç¾¤ç§ç±»</h3>
<p><strong>ã€€ã€€è´Ÿè½½å‡è¡¡é›†ç¾¤ LB </strong><strong>è§£å†³è°ƒåº¦é—®é¢˜</strong></p>
<p><strong>ã€€ã€€é«˜å¯ç”¨é›†ç¾¤&nbsp; HA </strong><strong>è§£å†³å•ç‚¹æ•…éšœé—®é¢˜ï¼ˆkeeplived</strong><strong>ï¼‰</strong></p>
<p>ã€€ã€€é«˜æ€§èƒ½è®¡ç®—é›†ç¾¤&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; HP ã€ç½‘ç»œè®¡ç®—é›†ç¾¤ GC</p>
<h3>1.2.2 ç¡¬ä»¶è®¾å¤‡</h3>
<div>
<p class="a">ã€€ã€€F5 è®¾å¤‡&nbsp; &nbsp;A10</p>
</div>
<h3>1.2.3 è½¯ä»¶</h3>
<div>
<p class="a">ã€€ã€€nginx ï¼ˆ7å±‚&nbsp; 1.9ç‰ˆæœ¬ä¹‹åæ”¯æŒ4å±‚ï¼‰ã€LVS ï¼ˆ4å±‚ï¼‰ã€HAproxy ï¼ˆ4å±‚ 7å±‚ï¼‰</p>
</div>
<h3>1.2.4 è´Ÿè½½å‡è¡¡æ¦‚å¿µè¯´æ˜</h3>
<p>ã€€ã€€å¯¹ç”¨æˆ·çš„è®¿é—®è¯·æ±‚è¿›è¡Œè°ƒåº¦ç®¡ç†</p>
<p>ã€€ã€€å¯¹ç”¨æˆ·çš„è®¿é—®è¯·æ±‚è¿›è¡Œå‹åŠ›åˆ†æ‹…</p>
<p align="center">&nbsp;<img data-original="http://clsn.io/wp-content/uploads/2018/03/1190037-20171217102011343-1991514696.jpg" src="blank.gif" tppabs="http://clsn.io/wp-content/themes/clsn-003/img/blank.gif" alt="Nginxçš„åå‘ä»£ç†ä¸è´Ÿè½½å‡è¡¡" alt="" /></p>

<h3>1.2.5 åå‘ä»£ç†</h3>
<p>ã€€ã€€æ¥æ”¶ç”¨æˆ·è¯·æ±‚ä»£æ›¿ç”¨æˆ·å‘åç«¯è®¿é—®</p>
<p>ã€€ã€€åå‘ä»£ç†ä¸æ•°æ®è½¬å‘çš„åŒºåˆ«</p>
<h3>1.2.6 å‹åŠ›æµ‹è¯•çš„æ–¹å¼</h3>
<p>ã€€ã€€ab ï¼ˆapacheé‡Œçš„å‘½ä»¤ï¼‰&nbsp;</p>
<p>ã€€ã€€é€šè¿‡&nbsp;&nbsp;&nbsp;<span class="cnblogs_code"><span style="color: #0000ff;">yum</span> <span style="color: #0000ff;">install</span> httpd-tools</span>&nbsp;&nbsp; è·å¾—</p>
<h2>1.3 nginxåå‘ä»£ç†å®è·µ</h2>
<h3>1.3.1 åœ°å€è§„åˆ’è¯´æ˜</h3>
<div align="center">
<div align="center">
<table class="MsoTableGrid" style="border-width: initial; border-style: none; border-color: initial;" border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td style="width: 174.25pt; border-width: 1pt; border-color: windowtext; background: #a6a6a6; padding: 0cm 5.4pt;" width="232">
<p class="MsoNormal" style="margin-bottom: .0001pt; text-align: justify; text-justify: inter-ideograph;"><strong><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">HOSTNAME</span></strong></p>
</td>
<td style="width: 174.25pt; border-top-width: 1pt; border-right-width: 1pt; border-bottom-width: 1pt; border-top-color: windowtext; border-right-color: windowtext; border-bottom-color: windowtext; border-left: none; background: #a6a6a6; padding: 0cm 5.4pt;" width="232">
<p class="MsoNormal" style="margin-bottom: .0001pt; text-align: justify; text-justify: inter-ideograph;"><strong><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">IP</span></strong></p>
</td>
<td style="width: 174.3pt; border-top-width: 1pt; border-right-width: 1pt; border-bottom-width: 1pt; border-top-color: windowtext; border-right-color: windowtext; border-bottom-color: windowtext; border-left: none; background: #a6a6a6; padding: 0cm 5.4pt;" width="232">
<p class="MsoNormal" style="margin-bottom: .0001pt; text-align: justify; text-justify: inter-ideograph;"><strong><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">è¯´æ˜</span></strong></p>
</td>
</tr>
<tr>
<td style="width: 174.25pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0cm 5.4pt;" width="232">
<p class="MsoNormal" style="margin-bottom: .0001pt; text-align: justify; text-justify: inter-ideograph;"><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">lb01</span></p>
</td>
<td style="width: 174.25pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: windowtext; border-right-width: 1pt; border-right-color: windowtext; padding: 0cm 5.4pt;" width="232">
<p class="MsoNormal" style="margin-bottom: .0001pt; text-align: justify; text-justify: inter-ideograph;"><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">10.0.0.5</span></p>
</td>
<td style="width: 174.3pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: windowtext; border-right-width: 1pt; border-right-color: windowtext; padding: 0cm 5.4pt;" width="232">
<p class="MsoNormal" style="margin-bottom: .0001pt; text-align: justify; text-justify: inter-ideograph;"><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">Nginx </span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">ä¸»è´Ÿè½½æœåŠ¡å™¨</span></p>
</td>
</tr>
<tr>
<td style="width: 174.25pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0cm 5.4pt;" width="232">
<p class="MsoNormal" style="margin-bottom: .0001pt; text-align: justify; text-justify: inter-ideograph;"><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">lb02</span></p>
</td>
<td style="width: 174.25pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: windowtext; border-right-width: 1pt; border-right-color: windowtext; padding: 0cm 5.4pt;" width="232">
<p class="MsoNormal" style="margin-bottom: .0001pt; text-align: justify; text-justify: inter-ideograph;"><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">10.0.0.6</span></p>
</td>
<td style="width: 174.3pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: windowtext; border-right-width: 1pt; border-right-color: windowtext; padding: 0cm 5.4pt;" width="232">
<p class="MsoNormal" style="margin-bottom: .0001pt; text-align: justify; text-justify: inter-ideograph;"><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">nginx </span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">è¾…è´Ÿè½½æœåŠ¡å™¨</span></p>
</td>
</tr>
<tr>
<td style="width: 174.25pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0cm 5.4pt;" width="232">
<p class="MsoNormal" style="margin-bottom: .0001pt; text-align: justify; text-justify: inter-ideograph;"><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">web01</span></p>
</td>
<td style="width: 174.25pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: windowtext; border-right-width: 1pt; border-right-color: windowtext; padding: 0cm 5.4pt;" width="232">
<p class="MsoNormal" style="margin-bottom: .0001pt; text-align: justify; text-justify: inter-ideograph;"><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">10.0.0.8</span></p>
</td>
<td style="width: 174.3pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: windowtext; border-right-width: 1pt; border-right-color: windowtext; padding: 0cm 5.4pt;" width="232">
<p class="MsoNormal" style="margin-bottom: .0001pt; text-align: justify; text-justify: inter-ideograph;"><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">web01</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">æœåŠ¡å™¨</span></p>
</td>
</tr>
<tr>
<td style="width: 174.25pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0cm 5.4pt;" width="232">
<p class="MsoNormal" style="margin-bottom: .0001pt; text-align: justify; text-justify: inter-ideograph;"><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">web02</span></p>
</td>
<td style="width: 174.25pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: windowtext; border-right-width: 1pt; border-right-color: windowtext; padding: 0cm 5.4pt;" width="232">
<p class="MsoNormal" style="margin-bottom: .0001pt; text-align: justify; text-justify: inter-ideograph;"><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">10.0.0.7</span></p>
</td>
<td style="width: 174.3pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: windowtext; border-right-width: 1pt; border-right-color: windowtext; padding: 0cm 5.4pt;" width="232">
<p class="MsoNormal" style="margin-bottom: .0001pt; text-align: justify; text-justify: inter-ideograph;"><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">web02</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">æœåŠ¡å™¨</span></p>
</td>
</tr>
<tr>
<td style="width: 174.25pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0cm 5.4pt;" width="232">
<p class="MsoNormal" style="margin-bottom: .0001pt; text-align: justify; text-justify: inter-ideograph;"><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">web03</span></p>
</td>
<td style="width: 174.25pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: windowtext; border-right-width: 1pt; border-right-color: windowtext; padding: 0cm 5.4pt;" width="232">
<p class="MsoNormal" style="margin-bottom: .0001pt; text-align: justify; text-justify: inter-ideograph;"><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">10.0.0.9</span></p>
</td>
<td style="width: 174.3pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: windowtext; border-right-width: 1pt; border-right-color: windowtext; padding: 0cm 5.4pt;" width="232">
<p class="MsoNormal" style="margin-bottom: .0001pt; text-align: justify; text-justify: inter-ideograph;"><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">web03</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">æœåŠ¡å™¨</span></p>
</td>
</tr>
<tr>
<td style="width: 522.8pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; background: #92d050; padding: 0cm 5.4pt;" colspan="3" width="697">
<p class="MsoNormal" style="margin-bottom: .0001pt; text-align: justify; text-justify: inter-ideograph;"><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">è¯´æ˜ï¼š</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">ä»¥ä¸Šä¸ºå®é™…ç”Ÿäº§æ¶æ„è´Ÿè½½å®ç°è§„åˆ’å†…å®¹</span></p>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<p class="a"><strong>ip</strong><strong>å‘½ä»¤è¯´æ˜</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #000000;">ip address show  æŸ¥çœ‹ipåœ°å€
ip route show  æŸ¥çœ‹è·¯ç”±ä¿¡æ¯</span></pre>
</div>
</div>
<h3>1.3.2 åå‘ä»£ç†ä¸æ•°æ®è½¬å‘çš„åŒºåˆ«</h3>
<p align="center"><img data-original="http://clsn.io/wp-content/uploads/2018/03/1190037-20171217102349374-1087598674.jpg" src="blank.gif" tppabs="http://clsn.io/wp-content/themes/clsn-003/img/blank.gif" alt="Nginxçš„åå‘ä»£ç†ä¸è´Ÿè½½å‡è¡¡" alt="" />&nbsp;</p>

<h3>1.3.3 å®‰è£…éƒ¨ç½²nginxè¿‡ç¨‹ï¼ˆå®‰è£…å‘½ä»¤é›†ï¼‰</h3>
<div>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">yum</span> <span style="color: #0000ff;">install</span> -y pcre-devel openssl-<span style="color: #000000;">devel
</span><span style="color: #0000ff;">mkdir</span> -p /server/<span style="color: #000000;">tools
cd </span>/server/<span style="color: #000000;">tools
</span><span style="color: #0000ff;">wget</span> -q http:<span style="color: #008000;">//</span><span style="color: #008000;">nginx.org/download/nginx-1.10.3.tar.gz</span>
<span style="color: #0000ff;">ls</span> -l nginx-<span style="color: #800080;">1.10</span>.<span style="color: #800080;">3</span>.<span style="color: #0000ff;">tar</span><span style="color: #000000;">.gz
useradd www </span>-s /sbin/nologin -<span style="color: #000000;">M
</span><span style="color: #0000ff;">tar</span> xf nginx-<span style="color: #800080;">1.10</span>.<span style="color: #800080;">3</span>.<span style="color: #0000ff;">tar</span><span style="color: #000000;">.gz
cd nginx</span>-<span style="color: #800080;">1.10</span>.<span style="color: #800080;">3</span><span style="color: #000000;">
.</span>/configure  --user=nginx --group=nginx --prefix=/application/nginx-<span style="color: #800080;">1.10</span>.<span style="color: #800080;">3</span> --with-http_stub_status_module  --with-<span style="color: #000000;">http_ssl_module
</span><span style="color: #0000ff;">make</span>
<span style="color: #0000ff;">make</span> <span style="color: #0000ff;">install</span>
<span style="color: #0000ff;">ln</span> -s /application/nginx-<span style="color: #800080;">1.10</span>.<span style="color: #800080;">3</span> /application/ngin</pre>
</div>
</div>
<h3>1.3.4 ç¼–å†™nginxé…ç½®æ–‡ä»¶ï¼ˆç»Ÿä¸€webæœåŠ¡å™¨é…ç½®ï¼‰</h3>
<div>
<div class="cnblogs_code">
<pre>worker_processes  <span style="color: #800080;">1</span><span style="color: #000000;">;
events {
    worker_connections  </span><span style="color: #800080;">1024</span><span style="color: #000000;">;
}
http {
    include       mime.types;
    default_type  application</span>/octet-<span style="color: #000000;">stream;
    sendfile        on;
    keepalive_timeout  </span><span style="color: #800080;">65</span><span style="color: #000000;">;
    log_format  main  </span><span style="color: #800000;">'</span><span style="color: #800000;">$remote_addr - $remote_user [$time_local] "$request" </span><span style="color: #800000;">'</span>
                      <span style="color: #800000;">'</span><span style="color: #800000;">$status $body_bytes_sent "$http_referer" </span><span style="color: #800000;">'</span>
                      <span style="color: #800000;">'</span><span style="color: #800000;">"$http_user_agent" "$http_x_forwarded_for"</span><span style="color: #800000;">'</span><span style="color: #000000;">;
    server {
        listen       </span><span style="color: #800080;">80</span><span style="color: #000000;">;
        server_name  bbs.etiantian.org;
        location </span>/<span style="color: #000000;"> {
            root   html</span>/<span style="color: #000000;">bbs;
            index  index.html index.htm;
        }
      access_log  logs</span>/<span style="color: #000000;">access_bbs.log  main;
    }        
    server {
        listen       </span><span style="color: #800080;">80</span><span style="color: #000000;">;
        server_name  www.etiantian.org;
        location </span>/<span style="color: #000000;"> {
            root   html</span>/<span style="color: #000000;">www;
            index  index.html index.htm;
        }
        access_log  logs</span>/<span style="color: #000000;">access_www.log  main;
    }
}</span></pre>
</div>
</div>
<h3>1.3.5 ç»Ÿä¸€nginxæµ‹è¯•ç¯å¢ƒ ï¼ˆwebæ–‡ä»¶ï¼‰</h3>
<div>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">mkdir</span> -p /application/nginx/html/<span style="color: #000000;">{www,bbs}
</span><span style="color: #0000ff;">for</span> name <span style="color: #0000ff;">in</span> www bbs; <span style="color: #0000ff;">do</span> <span style="color: #0000ff;">echo</span> $name `<span style="color: #0000ff;">hostname</span>` >/application/nginx/html/$name/xiaoxinxin.html;<span style="color: #0000ff;">done</span>
<span style="color: #0000ff;">for</span> name <span style="color: #0000ff;">in</span> www bbs; <span style="color: #0000ff;">do</span> <span style="color: #0000ff;">cat</span> /application/nginx/html/$name/xiaoxinxin.html;<span style="color: #0000ff;">done</span></pre>
</div>
</div>
<h3>1.3.6 æµ‹è¯•</h3>
<div>
<div class="cnblogs_code">
<pre>[<a href="email-protection.htm" tppabs="http://clsn.io/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="e4968b8b90a48886d4d5">[email&#160;protected]</a> ~]# curl -H host:bbs.etiantian.org  <span style="color: #800080;">10.0</span>.<span style="color: #800080;">0.8</span>/<span style="color: #000000;">xiaoxinxin.html
bbs web01
[<a href="email-protection.htm" tppabs="http://clsn.io/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="1e6c71716a5e727c2e2f">[email&#160;protected]</a> </span>~]# curl -H host:bbs.etiantian.org  <span style="color: #800080;">10.0</span>.<span style="color: #800080;">0.7</span>/<span style="color: #000000;">xiaoxinxin.html
bbs web02
[<a href="email-protection.htm" tppabs="http://clsn.io/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="86f4e9e9f2c6eae4b6b7">[email&#160;protected]</a> </span>~]# curl -H host:bbs.etiantian.org  <span style="color: #800080;">10.0</span>.<span style="color: #800080;">0.9</span>/<span style="color: #000000;">xiaoxinxin.html
bbs web03
[<a href="email-protection.htm" tppabs="http://clsn.io/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="a9dbc6c6dde9c5cb9998">[email&#160;protected]</a> </span>~]# curl -H host:www.etiantian.org  <span style="color: #800080;">10.0</span>.<span style="color: #800080;">0.8</span>/<span style="color: #000000;">xiaoxinxin.html
www web01
[<a href="email-protection.htm" tppabs="http://clsn.io/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="483a27273c08242a7879">[email&#160;protected]</a> </span>~]# curl -H host:www.etiantian.org  <span style="color: #800080;">10.0</span>.<span style="color: #800080;">0.7</span>/<span style="color: #000000;">xiaoxinxin.html
www web02
[<a href="email-protection.htm" tppabs="http://clsn.io/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="2d5f4242596d414f1d1c">[email&#160;protected]</a> </span>~]# curl -H host:www.etiantian.org  <span style="color: #800080;">10.0</span>.<span style="color: #800080;">0.9</span>/<span style="color: #000000;">xiaoxinxin.html
www web03</span></pre>
</div>
</div>
<h3>1.3.7 é…ç½®è´Ÿè½½æœåŠ¡æ–‡ä»¶</h3>
<div>
<div class="cnblogs_code">
<pre>worker_processes  <span style="color: #800080;">1</span><span style="color: #000000;">;
events {
    worker_connections  </span><span style="color: #800080;">1024</span><span style="color: #000000;">;
}
http {
    include       mime.types;
    default_type  application</span>/octet-<span style="color: #000000;">stream;
    sendfile        on;
    keepalive_timeout  </span><span style="color: #800080;">65</span><span style="color: #000000;">;                                  
    upstream server_pools {
        server </span><span style="color: #800080;">10.0</span>.<span style="color: #800080;">0.7</span>:<span style="color: #800080;">80</span><span style="color: #000000;">;
        server </span><span style="color: #800080;">10.0</span>.<span style="color: #800080;">0.8</span>:<span style="color: #800080;">80</span><span style="color: #000000;">;
        server </span><span style="color: #800080;">10.0</span>.<span style="color: #800080;">0.9</span>:<span style="color: #800080;">80</span><span style="color: #000000;">;
    } 
    server {
        listen </span><span style="color: #800080;">80</span><span style="color: #000000;">;
        server_name bbs.etiantian.org;
        location </span>/<span style="color: #000000;"> {
            proxy_pass http:</span><span style="color: #008000;">//</span><span style="color: #008000;">server_pools;</span>
<span style="color: #000000;">        }
    }</span></pre>
</div>
</div>
<h3>1.3.8 æµ‹è¯•è®¿é—®</h3>
<div>
<div class="cnblogs_code">
<pre>[<a href="email-protection.htm" tppabs="http://clsn.io/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="6614090912260a045657">[email&#160;protected]</a> conf]# curl -H host:bbs.etiantian.org <span style="color: #800080;">10.0</span>.<span style="color: #800080;">0.5</span>/<span style="color: #000000;">xiaoxinxin.html
bbs web03
[<a href="email-protection.htm" tppabs="http://clsn.io/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="53213c3c27133f316362">[email&#160;protected]</a> conf]# curl </span>-H host:bbs.etiantian.org <span style="color: #800080;">10.0</span>.<span style="color: #800080;">0.5</span>/<span style="color: #000000;">xiaoxinxin.html
bbs web02
[<a href="email-protection.htm" tppabs="http://clsn.io/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="bcced3d3c8fcd0de8c8d">[email&#160;protected]</a> conf]# curl </span>-H host:bbs.etiantian.org <span style="color: #800080;">10.0</span>.<span style="color: #800080;">0.5</span>/<span style="color: #000000;">xiaoxinxin.html
bbs web01</span></pre>
</div>
</div>
<h2>1.4 nginxä¸­å¸¸ç”¨æ¨¡å—è¯´æ˜</h2>
<div>
<div class="cnblogs_code">
<pre><span style="color: #000000;">ngx_http_status_module
ngx_http_ssl_module
ngx_http_log_module
ngx_http_upstream_module
ngx_http_proxy_module</span></pre>
</div>
</div>
<h3>1.4.1 æ¨¡å—è°ƒåº¦ç®—æ³•</h3>
<div>
<p class="a">&nbsp;ã€€ã€€&nbsp;&nbsp; â‘ . å®šä¹‰è½®è¯¢è°ƒåº¦ç®—æ³•-rr-é»˜è®¤è°ƒåº¦ç®—æ³•</p>
<p class="a">ã€€ã€€&nbsp;&nbsp;&nbsp; â‘¡. å®šä¹‰æƒé‡è°ƒåº¦ç®—æ³•-wrr</p>
<p class="a">&nbsp;&nbsp;ã€€ã€€&nbsp; â‘¢. å®šä¹‰é™æ€è°ƒåº¦ç®—æ³•-ip_hash</p>
<p class="a">&nbsp;&nbsp;ã€€ã€€&nbsp; â‘£. å®šä¹‰æœ€å°çš„è¿æ¥æ•°-least_conn</p>
</div>
<h3>1.4.2 nginxåå‘ä»£ç†ç›¸å…³ä¸¤ä¸ªæ¨¡å—</h3>
<p>ã€€ã€€ã€€ã€€upstream æ¨¡å— ç±»ä¼¼ä¸ä¸€ä¸ªæ± å¡˜ï¼Œå°†nginxèŠ‚ç‚¹æ”¾ç½®åˆ°æ± å¡˜ä¸­</p>
<p>ã€€ã€€ã€€ã€€proxyæ¨¡å—&nbsp; ç”¨æ± å¡˜é‡Œé¢çš„nginxèŠ‚ç‚¹ï¼Œåˆ©ç”¨pr oxyè¿›è¡Œè°ƒç”¨</p>
<h3>1.4.3 upstreamæ¨¡å—æ ¸å¿ƒå‚æ•°ç®€ä»‹</h3>
<p>ã€€ã€€ã€€ã€€weight æƒé‡</p>
<p>ã€€ã€€ã€€ã€€max_fails æŠ›å¾—æ¬¡æ•°</p>
<p>ã€€ã€€ã€€ã€€fail_timeout å¤±è´¥çš„è¶…æ—¶æ—¶é—´</p>
<p>ã€€ã€€ã€€ã€€backup&nbsp; å¤‡ä»½</p>
<h3>1.4.4 weight å‚æ•°å®è·µ ï¼ˆæƒé‡ï¼‰</h3>
<p>ã€€ã€€upstream æ¨¡å—åªèƒ½åœ¨httpåŒºå—é‡Œ</p>
<div>
<div class="cnblogs_code">
<pre>worker_processes  <span style="color: #800080;">1</span><span style="color: #000000;">;
events {
    worker_connections  </span><span style="color: #800080;">1024</span><span style="color: #000000;">;
}
http {
    include       mime.types;
    default_type  application</span>/octet-<span style="color: #000000;">stream;
    sendfile        on;
    keepalive_timeout  </span><span style="color: #800080;">65</span><span style="color: #000000;">;
    upstream server_pools{
         server </span><span style="color: #800080;">10.0</span>.<span style="color: #800080;">0.7</span>:<span style="color: #800080;">80</span> weight=<span style="color: #800080;">1</span><span style="color: #000000;">;
         server </span><span style="color: #800080;">10.0</span>.<span style="color: #800080;">0.8</span>:<span style="color: #800080;">80</span> weight=<span style="color: #800080;">2</span><span style="color: #000000;">;
    }
    server{
       listen </span><span style="color: #800080;">80</span><span style="color: #000000;">;
       server_name bbs.etiantian.org;
       location </span>/<span style="color: #000000;"> {
          proxy_pass http:</span><span style="color: #008000;">//</span><span style="color: #008000;">server_pools;</span>
<span style="color: #000000;">       }
    }
}</span></pre>
</div>
</div>
<p>æµ‹è¯•</p>
<div>
<div class="cnblogs_code">
<pre>[<a href="email-protection.htm" tppabs="http://clsn.io/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="81f3eeeef5c1f5e4f2f5">[email&#160;protected]</a> tools]# curl <span style="color: #800080;">10.0</span>.<span style="color: #800080;">0.5</span><span style="color: #000000;">
web01 www
[<a href="email-protection.htm" tppabs="http://clsn.io/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="05776a6a714571607671">[email&#160;protected]</a> tools]# curl </span><span style="color: #800080;">10.0</span>.<span style="color: #800080;">0.5</span><span style="color: #000000;">
web01 www
[<a href="email-protection.htm" tppabs="http://clsn.io/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="cdbfa2a2b98db9a8beb9">[email&#160;protected]</a> tools]# curl </span><span style="color: #800080;">10.0</span>.<span style="color: #800080;">0.5</span><span style="color: #000000;">
web02 www
[<a href="email-protection.htm" tppabs="http://clsn.io/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="1b6974746f5b6f7e686f">[email&#160;protected]</a> tools]# curl </span><span style="color: #800080;">10.0</span>.<span style="color: #800080;">0.5</span><span style="color: #000000;">
web01 www
[<a href="email-protection.htm" tppabs="http://clsn.io/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="f785989883b783928483">[email&#160;protected]</a> tools]# curl </span><span style="color: #800080;">10.0</span>.<span style="color: #800080;">0.5</span><span style="color: #000000;">
web01 www
[<a href="email-protection.htm" tppabs="http://clsn.io/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="9deff2f2e9dde9f8eee9">[email&#160;protected]</a> tools]# curl </span><span style="color: #800080;">10.0</span>.<span style="color: #800080;">0.5</span><span style="color: #000000;">
web02 www</span></pre>
</div>
</div>
<h3>1.4.5 å…¶ä»–çš„å‚æ•°è¯´æ˜</h3>
<p>ã€€ã€€max_fails&nbsp;&nbsp;&nbsp; å¤±è´¥çš„å°è¯•æ¬¡æ•°</p>
<p>ã€€ã€€fail_timeout å¤±è´¥åçš„å†æ¬¡å°è¯•æ—¶é—´</p>
<p>ã€€ã€€backup å¤‡ä»½èŠ‚ç‚¹ï¼šæ‰€æœ‰çš„èŠ‚ç‚¹éƒ½æŒ‚æ‰åæ•°æ®æ‰ä¼šè¯·æ±‚web01</p>
<div>
<div class="cnblogs_code">
<pre>server <span style="color: #800080;">10.0</span>.<span style="color: #800080;">0.7</span>:<span style="color: #800080;">80</span> weight=<span style="color: #800080;">1</span> max_fails=<span style="color: #800080;">3</span> fail_timeout=<span style="color: #800080;">10</span><span style="color: #000000;"> ;
server </span><span style="color: #800080;">10.0</span>.<span style="color: #800080;">0.8</span>:<span style="color: #800080;">80</span> weight=<span style="color: #800080;">2</span> max_fails=<span style="color: #800080;">3</span> fail_timeout=<span style="color: #800080;">10</span> backup;</pre>
</div>
</div>
<p>æµ‹è¯•ï¼Œå°†web02åœæ‰</p>
<div>
<div class="cnblogs_code">
<pre>[<a href="email-protection.htm" tppabs="http://clsn.io/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="ed9f828299ad99889e99">[email&#160;protected]</a> tools]# curl <span style="color: #800080;">10.0</span>.<span style="color: #800080;">0.5</span><span style="color: #000000;">
web02 www
[<a href="email-protection.htm" tppabs="http://clsn.io/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="0b7964647f4b7f6e787f">[email&#160;protected]</a> tools]# curl </span><span style="color: #800080;">10.0</span>.<span style="color: #800080;">0.5</span><span style="color: #000000;">
web02 www</span></pre>
</div>
</div>
<p>åœæ‰web02å</p>
<div>
<div class="cnblogs_code">
<pre>[<a href="email-protection.htm" tppabs="http://clsn.io/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="5f2d30302b1f2b3a2c2b">[email&#160;protected]</a> tools]# curl <span style="color: #800080;">10.0</span>.<span style="color: #800080;">0.5</span><span style="color: #000000;">
web01 www
[<a href="email-protection.htm" tppabs="http://clsn.io/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="1f6d70706b5f6b7a6c6b">[email&#160;protected]</a> tools]# curl </span><span style="color: #800080;">10.0</span>.<span style="color: #800080;">0.5</span><span style="color: #000000;">
web01 www
[<a href="email-protection.htm" tppabs="http://clsn.io/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="02706d6d764276677176">[email&#160;protected]</a> tools]# curl </span><span style="color: #800080;">10.0</span>.<span style="color: #800080;">0.5</span></pre>
</div>
</div>
<h3>1.4.6 è®¿é—®æŠ“åŒ…</h3>
<p>ç”¨æˆ·è¯·æ±‚æŠ¥æ–‡</p>
<p align="center"><img data-original="http://clsn.io/wp-content/uploads/2018/03/1190037-20171217102759389-1917826599.png" src="blank.gif" tppabs="http://clsn.io/wp-content/themes/clsn-003/img/blank.gif" alt="Nginxçš„åå‘ä»£ç†ä¸è´Ÿè½½å‡è¡¡" alt="" />&nbsp;</p>

<p>è´Ÿè½½å‡è¡¡è¯·æ±‚æŠ¥æ–‡</p>
<p align="center">&nbsp;<img data-original="http://clsn.io/wp-content/uploads/2018/03/1190037-20171217102839827-407799546.png" src="blank.gif" tppabs="http://clsn.io/wp-content/themes/clsn-003/img/blank.gif" alt="Nginxçš„åå‘ä»£ç†ä¸è´Ÿè½½å‡è¡¡" alt="" /></p>

<div>
<p class="a">è¯´æ˜ï¼š</p>
<p class="a">&nbsp;&nbsp;&nbsp; hosts ä¸»æœºå¤´ä¸åŒï¼Œæœªé…ç½®proxy_set_header Host $host å‚æ•°ï¼Œåœ¨è´Ÿè½½å‡è¡¡è®¿é—®çš„æ—¶å€™ä¼šä¸å¸¦hostsä¿¡æ¯ã€‚</p>
</div>
<h3>1.4.7 upsrteamå‚æ•°è¯¦ç»†è¯´æ˜</h3>
<table class="MsoTable15Grid4Accent5" style="width: 100%; border-width: initial; border-style: none; border-color: initial;" border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td style="width: 11.8%; border-top-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-top-color: #4472c4; border-bottom-color: #4472c4; border-left-color: #4472c4; border-right: none; background: #4472c4; padding: 0cm 5.4pt;" valign="top" width="11%">
<p class="MsoNormal" style="margin-bottom: .0001pt; mso-yfti-cnfc: 5;"><strong><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“; color: white; mso-themecolor: background1;" lang="EN-US">upstream</span></strong><strong><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; color: white; mso-themecolor: background1;">æ¨¡å—å†…å‚æ•°</span></strong></p>
</td>
<td style="width: 88.2%; border-top-width: 1pt; border-right-width: 1pt; border-bottom-width: 1pt; border-top-color: #4472c4; border-right-color: #4472c4; border-bottom-color: #4472c4; border-left: none; background: #4472c4; padding: 0cm 5.4pt;" valign="top" width="88%">
<p class="MsoNormal" style="margin-bottom: .0001pt; mso-yfti-cnfc: 1;"><strong><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; color: white; mso-themecolor: background1;">å‚æ•°è¯´æ˜</span></strong></p>
</td>
</tr>
<tr>
<td style="width: 11.8%; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: #8eaadb; border-bottom-color: #8eaadb; border-left-color: #8eaadb; border-top: none; background: #d9e2f3; padding: 0cm 5.4pt;" valign="top" width="11%">
<p class="MsoNormal" style="margin-bottom: .0001pt; mso-yfti-cnfc: 68;"><strong><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">server 10.0.10.8:80</span></strong></p>
</td>
<td style="width: 88.2%; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: #8eaadb; border-right-width: 1pt; border-right-color: #8eaadb; background: #d9e2f3; padding: 0cm 5.4pt;" valign="top" width="88%">
<p class="MsoNormal" style="margin-bottom: .0001pt; mso-yfti-cnfc: 64;"><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">è´Ÿè½½å‡è¡¡åé¢çš„</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">RS</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">é…ç½®ï¼Œå¯ä»¥æ˜¯</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">IP</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">æˆ–åŸŸåï¼Œå¦‚æœç«¯å£ä¸å†™ï¼Œé»˜è®¤æ˜¯</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">80</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">ç«¯å£ã€‚</span></p>
<p class="MsoNormal" style="margin-bottom: .0001pt; mso-yfti-cnfc: 64;"><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">é«˜å¹¶å‘åœºæ™¯ä¸‹ï¼Œ</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US"> IP</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">å¯æ¢æˆåŸŸåï¼Œé€šè¿‡</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US"> DNS</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">åšè´Ÿè½½å‡è¡¡ã€‚</span></p>
</td>
</tr>
<tr>
<td style="width: 11.8%; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: #8eaadb; border-bottom-color: #8eaadb; border-left-color: #8eaadb; border-top: none; padding: 0cm 5.4pt;" valign="top" width="11%">
<p class="MsoNormal" style="margin-bottom: .0001pt; mso-yfti-cnfc: 4;"><strong><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">weigth=1</span></strong></p>
</td>
<td style="width: 88.2%; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: #8eaadb; border-right-width: 1pt; border-right-color: #8eaadb; padding: 0cm 5.4pt;" valign="top" width="88%">
<p class="MsoNormal" style="margin-bottom: .0001pt;"><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">ä»£è¡¨æœåŠ¡å™¨çš„æƒé‡ï¼Œé»˜è®¤å€¼æ˜¯</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">1</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">ã€‚æƒé‡æ•°å­—è¶Šå¤§è¡¨ç¤ºæ¥å—çš„è¯·æ±‚æ¯”ä¾‹è¶Šå¤§ã€‚</span></p>
</td>
</tr>
<tr>
<td style="width: 11.8%; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: #8eaadb; border-bottom-color: #8eaadb; border-left-color: #8eaadb; border-top: none; background: #d9e2f3; padding: 0cm 5.4pt;" valign="top" width="11%">
<p class="MsoNormal" style="margin-bottom: .0001pt; mso-yfti-cnfc: 68;"><strong><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">max_fails=3</span></strong></p>
</td>
<td style="width: 88.2%; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: #8eaadb; border-right-width: 1pt; border-right-color: #8eaadb; background: #d9e2f3; padding: 0cm 5.4pt;" valign="top" width="88%">
<p class="MsoNormal" style="margin-bottom: .0001pt; mso-yfti-cnfc: 64;"><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">Nginx</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">å°è¯•è¿æ¥åç«¯ä¸»æœºå¤±è´¥çš„æ¬¡æ•°ï¼Œè¿™ä¸ªå€¼æ˜¯é…åˆ</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US"> proxy_next_upstream</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">ã€</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">fastcgi_next_upstream</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">å’Œ</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">memcached_next_upstream </span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">è¿™ä¸‰ä¸ªå‚æ•°æ¥ä½¿ç”¨çš„ã€‚å½“</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">nginx</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">æ¥æ”¶åç«¯æœåŠ¡å™¨è¿”å›è¿™ä¸‰ä¸ªå‚æ•°å®šä¹‰çš„çŠ¶æ€ç æ—¶ï¼Œä¼šå°†è¿™ä¸ªè¯·æ±‚è½¬å‘ç»™æ­£å¸¸å·¥ä½œçš„åç«¯æœåŠ¡å™¨ï¼Œä¾‹å¦‚</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">404</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">ã€</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">502</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">ã€</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">503</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">ã€</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US"> Max_fails</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">çš„é»˜è®¤å€¼æ˜¯</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">1 ; </span></p>
<p class="MsoNormal" style="margin-bottom: .0001pt; mso-yfti-cnfc: 64;"><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">ä¼ä¸šåœºæ™¯ä¸‹å»ºè®®</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">2-3</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">æ¬¡ã€‚å¦‚äº¬ä¸œ</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">1</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">æ¬¡ï¼Œè“æ±›</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">10</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">æ¬¡ï¼Œæ ¹æ®ä¸šåŠ¡éœ€æ±‚å»é…ç½®</span></p>
</td>
</tr>
<tr>
<td style="width: 11.8%; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: #8eaadb; border-bottom-color: #8eaadb; border-left-color: #8eaadb; border-top: none; padding: 0cm 5.4pt;" valign="top" width="11%">
<p class="MsoNormal" style="margin-bottom: .0001pt; mso-yfti-cnfc: 4;"><strong><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">fail_timeout=10s</span></strong></p>
</td>
<td style="width: 88.2%; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: #8eaadb; border-right-width: 1pt; border-right-color: #8eaadb; padding: 0cm 5.4pt;" valign="top" width="88%">
<p class="MsoNormal" style="margin-bottom: .0001pt;"><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">åœ¨</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">max_fails</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">å®šä¹‰çš„å¤±è´¥æ¬¡æ•°åï¼Œè·ç¦»ä¸‹æ¬¡æ£€æŸ¥çš„é—´éš”æ—¶é—´ï¼Œé»˜è®¤æ˜¯</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">10s ;</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">å¦‚æœ</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">max_fails</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">æ˜¯</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">5 ,</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">å®ƒå°±æ£€æµ‹</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">5</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">æ¬¡ï¼Œå¦‚æœ</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">5</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">æ¬¡éƒ½æ˜¯</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">502,</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">é‚£ä¹ˆï¼Œå®ƒå°±ä¼šæ ¹æ®</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">fail_timeout</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">çš„å€¼ï¼Œç­‰å¾…</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">10s</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">å†å»æ£€æŸ¥ï¼Œè¿˜æ˜¯åªæ£€æŸ¥ä¸€æ¬¡ï¼Œå¦‚æœæŒç»­</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">502,</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">åœ¨ä¸é‡æ–°åŠ è½½</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US"> Nginx</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">é…ç½®çš„æƒ…å†µä¸‹ï¼Œæ¯éš”</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">10s</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">éƒ½åªæ£€æŸ¥ä¸€æ¬¡ã€‚å¸¸è§„ä¸šåŠ¡</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">2~3</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">ç§’æ¯”è¾ƒåˆç†ï¼Œæ¯”å¦‚äº¬ä¸œ</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">3</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">ç§’ï¼Œè“æ±›</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">3</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">ç§’ï¼Œå¯æ ¹æ®ä¸šåŠ¡éœ€æ±‚å»é…ç½®ã€‚</span></p>
</td>
</tr>
<tr>
<td style="width: 11.8%; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: #8eaadb; border-bottom-color: #8eaadb; border-left-color: #8eaadb; border-top: none; background: #d9e2f3; padding: 0cm 5.4pt;" valign="top" width="11%">
<p class="MsoNormal" style="margin-bottom: .0001pt; mso-yfti-cnfc: 68;"><strong><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">backup</span></strong></p>
</td>
<td style="width: 88.2%; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: #8eaadb; border-right-width: 1pt; border-right-color: #8eaadb; background: #d9e2f3; padding: 0cm 5.4pt;" valign="top" width="88%">
<p class="MsoNormal" style="margin-bottom: .0001pt; mso-yfti-cnfc: 64;"><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">çƒ­å¤‡é…ç½®ï¼ˆ</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">RS</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">èŠ‚ç‚¹çš„é«˜å¯ç”¨ï¼‰ï¼Œå½“å‰é¢æ¿€æ´»çš„</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">RS</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">éƒ½å¤±è´¥åä¼šè‡ªåŠ¨å¯ç”¨çƒ­å¤‡</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">RS</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">è¿™æ ‡å¿—çœ‹è¿™ä¸ªæœåŠ¡å™¨ä½œä¸ºå¤‡ä»½æœåŠ¡å™¨ï¼Œè‹¥ä¸»æœåŠ¡å™¨å…¨éƒ¨å®•æœºäº†ï¼Œå°±ä¼šå‘å®ƒè½¬å‘è¯·æ±‚ã€‚</span></p>
<p class="MsoNormal" style="margin-bottom: .0001pt; mso-yfti-cnfc: 64;"><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">æ³¨æ„ï¼šå½“è´Ÿè½½è°ƒåº¦ç®—æ³•ä¸º</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">ip_hash</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">æ—¶ï¼Œåç«¯æœåŠ¡å™¨åœ¨è´Ÿè½½å‡è¡¡è°ƒåº¦ä¸­çš„çŠ¶æ€ä¸èƒ½æ˜¯</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">weight</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">å’Œ</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">backup</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">ã€‚</span></p>
</td>
</tr>
<tr>
<td style="width: 11.8%; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: #8eaadb; border-bottom-color: #8eaadb; border-left-color: #8eaadb; border-top: none; padding: 0cm 5.4pt;" valign="top" width="11%">
<p class="MsoNormal" style="margin-bottom: .0001pt; mso-yfti-cnfc: 4;"><strong><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">down</span></strong></p>
</td>
<td style="width: 88.2%; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: #8eaadb; border-right-width: 1pt; border-right-color: #8eaadb; padding: 0cm 5.4pt;" valign="top" width="88%">
<p class="MsoNormal" style="margin-bottom: .0001pt;"><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">è¿™æ ‡å¿—ç€æœåŠ¡å™¨æ°¸è¿œä¸å¯ç”¨ï¼Œè¿™ä¸ªå‚æ•°å¯é…åˆ</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">ip_hash</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">ä½¿ç”¨ï¼›ç±»ä¼¼ä¸æ³¨é‡Šã€‚</span></p>
</td>
</tr>
</tbody>
</table>
<h3><span style="font-size: 14px;">ã€€ã€€weight :è°ƒèŠ‚æœåŠ¡å™¨çš„è¯·æ±‚åˆ†é…æƒé‡ã€‚</span>1.4.8 ä¸Šè¿°å‘½ä»¤çš„è¯´æ˜å¦‚ä¸‹ï¼š</h3>
<p>ã€€ã€€ã€€ã€€?check :å¼€å¯å¯¹è¯¥æœåŠ¡å™¨å¥åº·æ£€æŸ¥ã€‚</p>
<p>ã€€ã€€ã€€ã€€?inter:è®¾ç½®è¿ç»­ä¸¤æ¬¡çš„å¥åº·æ£€æŸ¥é—´éš”æ—¶é—´ï¼Œå•ä½æ¯«ç§’ï¼Œé»˜è®¤å€¼2000ã€‚</p>
<p>ã€€ã€€ã€€ã€€?rise :æŒ‡å®šå¤šå°‘æ¬¡è¿ç»­æˆåŠŸçš„å¥åº·æ£€æŸ¥åï¼Œå³å¯è®¤å®šè¯¥æœåŠ¡å™¨å¤„äºå¯ç”¨çŠ¶æ€ã€‚</p>
<p>ã€€ã€€ã€€ã€€?fall :æŒ‡å®šå¤šå°‘æ¬¡ä¸æˆåŠŸçš„å¥åº·æ£€æŸ¥åï¼Œå³è®¤ä¸ºæœåŠ¡å™¨ä¸ºå®•æœºçŠ¶æ€ï¼Œé»˜è®¤å€¼3ã€‚</p>
<p>ã€€ã€€ã€€ã€€? maxconn :æŒ‡å®šå¯è¢«å‘é€åˆ°è¯¥æœåŠ¡å™¨çš„æœ€å¤§å¹¶å‘è¿æ¥æ•°ã€‚</p>
<div>
<div style="mso-element: para-border-div; border: solid windowtext 2.0pt; padding: 1.0pt 4.0pt 1.0pt 4.0pt; mso-border-shadow: yes; background: #F2F2F2; mso-shading: windowtext; mso-pattern: gray-5 auto; margin-left: 38.95pt; margin-right: 76.8pt;">
<p class="a" style="margin: 1pt 0cm; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><span style="font-family: 'å¾®è½¯é›…é»‘',sans-serif; mso-ascii-font-family: å®‹ä½“; mso-hansi-font-family: å®‹ä½“;">è™½ç„¶</span><span lang="EN-US">Nginx</span><span style="font-family: 'å¾®è½¯é›…é»‘',sans-serif; mso-ascii-font-family: å®‹ä½“; mso-hansi-font-family: å®‹ä½“;">æœ¬èº«ä¸æ”¯æŒä¸€è‡´æ€§</span><span lang="EN-US">hash</span><span style="font-family: 'å¾®è½¯é›…é»‘',sans-serif; mso-ascii-font-family: å®‹ä½“; mso-hansi-font-family: å®‹ä½“;">ç®—æ³•ï¼Œä½†</span><span lang="EN-US">Nginx</span><span style="font-family: 'å¾®è½¯é›…é»‘',sans-serif; mso-ascii-font-family: å®‹ä½“; mso-hansi-font-family: å®‹ä½“;">çš„åˆ†æ”¯</span><span lang="EN-US">Tengine</span><span style="font-family: 'å¾®è½¯é›…é»‘',sans-serif; mso-ascii-font-family: å®‹ä½“; mso-hansi-font-family: å®‹ä½“;">æ”¯æŒã€‚è¯¦ç»†å¯è§</span><span lang="EN-US">http://tengine.taobao.org/document_cn/http_upstream_consistent_hash_cn.html</span></p>
</div>
</div>
<h3>1.4.9 ip_hash å‚æ•°å®è·µ</h3>
<p>ã€€ã€€æ¯ä¸ªè®¿é—®çš„ç”¨æˆ·éƒ½ä¼šç”Ÿæˆä¸€ä¸ªhashå€¼ã€‚</p>
<p>&nbsp;&nbsp;&nbsp; &nbsp; æ¯ä¸ªè¯·æ±‚æŒ‰å®¢æˆ·ç«¯ IPçš„ hashç»“æœåˆ†é…ï¼Œå½“æ–°çš„è¯·æ±‚åˆ°è¾¾æ—¶ï¼Œå…ˆå°†å…¶å®¢æˆ·ç«¯ IPé€šè¿‡å“ˆå¸Œç®—æ³•å“ˆå¸Œå‡ºä¸€ä¸ªå€¼ï¼Œåœ¨éšåçš„å®¢æˆ·ç«¯è¯·æ±‚ä¸­ï¼Œå®¢æˆ·IPçš„å’å¸Œå€¼åªè¦ç›¸åŒï¼Œå°±ä¼šè¢«åˆ†é…è‡³åŒä¸€å°æœåŠ¡å™¨ï¼Œè¯¥è°ƒåº¦ç®—æ³•å¯ä»¥è§£å†³åŠ¨æ€ç½‘é¡µçš„sessionå…±äº«é—®é¢˜ï¼Œä½†æœ‰æ—¶ä¼šå¯¼è‡´è¯·æ±‚åˆ†é…ä¸å‡ï¼Œå³æ— æ³•ä¿è¯1:1çš„è´Ÿè½½å‡è¡¡ï¼Œå› ä¸ºåœ¨å›½å†…å¤§å¤šæ•°å…¬å¸éƒ½æ˜¯NATä¸Šç½‘æ¨ªå¼ï¼Œå¤šä¸ªå®¢æˆ·ç«¯ä¼šå¯¹åº”_ä¸ªå¤–éƒ¨IP ,æ‰€ä»¥ï¼Œè¿™äº›å®¢æˆ·ç«¯éƒ½ä¼šè¢«åˆ†é…åˆ°åŒä¸€èŠ‚ç‚¹æœåŠ¡å™¨ï¼Œä»è€Œå¯¼è‡´è¯·æ±‚åˆ†é…ä¸å‡ã€‚</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LVSè´Ÿè½½å‡è¡¡çš„-på‚æ•°ã€Keepalivedé…ç½®é‡Œçš„ persistence jimeout 50å‚æ•°éƒ½ç±»ä¼¼è¿™ä¸ª Nginxé‡Œçš„ip_hashå‚æ•°ï¼Œå…¶åŠŸèƒ½éƒ½å¯ä»¥è§£å†³åŠ¨æ€ç½‘é¡µçš„sessionå…±äº«é—®é¢˜ã€‚</p>
<div>
<div class="cnblogs_code">
<pre>worker_processes  <span style="color: #800080;">1</span><span style="color: #000000;">;
events {
    worker_connections  </span><span style="color: #800080;">1024</span><span style="color: #000000;">;
}
http {
    include       mime.types;
    default_type  application</span>/octet-<span style="color: #000000;">stream;
    sendfile        on;
    keepalive_timeout  </span><span style="color: #800080;">65</span><span style="color: #000000;">;
    upstream server_pools{
            ip_hash;
         server </span><span style="color: #800080;">10.0</span>.<span style="color: #800080;">0.7</span>:<span style="color: #800080;">80</span><span style="color: #000000;">;
         server </span><span style="color: #800080;">10.0</span>.<span style="color: #800080;">0.8</span>:<span style="color: #800080;">80</span><span style="color: #000000;">;
    }
    server{
       listen </span><span style="color: #800080;">80</span><span style="color: #000000;">;
       server_name bbs.etiantian.org;
       location </span>/<span style="color: #000000;"> {
          proxy_pass http:</span><span style="color: #008000;">//</span><span style="color: #008000;">server_pools;</span>
<span style="color: #000000;">       }
    }
}</span></pre>
</div>
</div>
<h3>1.4.10 least_conn å‚æ•°</h3>
<p>ã€€ã€€çœ‹è°é—²ï¼Œè°é—²å‘é€ç»™è°</p>
<p>ã€€ã€€least_connç®—æ³•ä¼šæ ¹æ®åç«¯èŠ‚ç‚¹çš„è¿æ¥æ•°æ¥å†³å®šåˆ†é…æƒ…å†µï¼Œå“ªä¸ªæœºå™¨è¿æ¥æ•°å°‘å°±åˆ†å‘ã€‚</p>
<h3>1.4.11 fair å‚æ•°</h3>
<p>ã€€ã€€çœ‹è°å“åº”çš„å¿«</p>
<p>ã€€ã€€æ­¤ç®—æ³•ä¼šæ ¹æ®åç«¯èŠ‚ç‚¹æœåŠ¡å™¨çš„å“åº”æ—¶é—´æ¥åˆ†é…è¯·æ±‚,å“åº”æ—¶é—´çŸ­çš„ä¼˜å…ˆåˆ†é…ã€‚è¿™æ˜¯æ›´åŠ æ™ºèƒ½çš„è°ƒåº¦ç®—æ³•ã€‚æ­¤ç§ç®—æ³•å¯ä»¥ä¾æ®é¡µé¢å¤§å°å’ŒåŠ è½½æ—¶é—´é•¿çŸ­æ™ºèƒ½åœ°è¿›è¡Œè´Ÿè½½å‡è¡ï¼Œä¹Ÿå°±æ˜¯æ ¹æ®åç«¯æœåŠ¡å™¨çš„å“åº”æ—¶é—´æ¥åˆ†é…è¯·æ±‚ï¼Œå“åº”æ—¶é—´çŸ­çš„ä¼˜å…ˆåˆ†é…ã€‚Nginxæœ¬èº«ä¸æ”¯æŒfairè°ƒåº¦ç®—æ³•ï¼Œå¦‚æœéœ€è¦ä½¿ç”¨è¿™ç§è°ƒåº¦ç®—æ³•ï¼Œå¿…é¡»ä¸‹è½½Nginxçš„ç›¸å…³æ¨¡å—upstream_fairã€‚</p>
<p>ç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<div>
<div class="cnblogs_code">
<pre><span style="color: #000000;">upstream name {
server </span><span style="color: #800080;">192.168</span>.<span style="color: #800080;">1.1</span><span style="color: #000000;">;
server </span><span style="color: #800080;">192.168</span>.<span style="color: #800080;">1.2</span><span style="color: #000000;">;
fair;
}</span></pre>
</div>
<p>ã€€ã€€é™¤äº†ä¸Šé¢è¿™äº›ç®—æ³•å¤–ï¼Œè¿˜æœ‰ä¸€äº›ç¬¬ä¸‰æ–¹è°ƒåº¦ç®—æ³•ï¼Œä¾‹å¦‚ï¼šurl_hashã€ä¸€è‡´æ€§hashç®—æ³•ç­‰.</p>
</div>
<h3>1.4.12 è°ƒåº¦ç®—æ³•</h3>
<p>ã€€ã€€å®šä¹‰è½®è¯¢è°ƒåº¦ç®—æ³• rr é»˜è®¤è°ƒåº¦ç®—æ³•&nbsp;&nbsp; å¹³å‡åˆ†é…</p>
<p>ã€€ã€€å®šä¹‰æƒé‡è°ƒåº¦ç®—æ³• wrr</p>
<p>ã€€ã€€å®šä¹‰é™æ€è°ƒåº¦ç®—æ³• ip-hash</p>
<p>ã€€ã€€å®šä¹‰æœ€å°çš„è¿æ¥æ•°-least_conn</p>
<h3>1.4.13 nginxè´Ÿè½½å‡è¡¡ç›¸å…³é‡è¦å‚æ•°</h3>
<table class="MsoTableGrid" style="width: 100%; border-width: initial; border-style: none; border-color: initial;" border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td style="width: 24.66%; border-width: 1pt; border-color: windowtext; background: #a6a6a6; padding: 0cm 5.4pt;" width="24%">
<p class="MsoNormal" style="margin-bottom: .0001pt; text-align: center;" align="center"><strong><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">Nginx</span></strong><strong><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">åå‘ä»£ç†é‡è¦å‚æ•</span></strong></p>
</td>
<td style="width: 75.34%; border-top-width: 1pt; border-right-width: 1pt; border-bottom-width: 1pt; border-top-color: windowtext; border-right-color: windowtext; border-bottom-color: windowtext; border-left: none; background: #a6a6a6; padding: 0cm 5.4pt;" width="75%">
<p class="MsoNormal" style="margin-bottom: .0001pt; text-align: center;" align="center"><strong><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">è§£é‡Šè¯´æ˜</span></strong></p>
</td>
</tr>
<tr>
<td style="width: 24.66%; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0cm 5.4pt;" width="24%">
<p class="MsoNormal" style="margin-bottom: .0001pt; text-align: justify; text-justify: inter-ideograph;"><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">proxy.pass http://server_pools;&nbsp; </span></p>
</td>
<td style="width: 75.34%; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: windowtext; border-right-width: 1pt; border-right-color: windowtext; padding: 0cm 5.4pt;" width="75%">
<p class="MsoNormal" style="margin-bottom: .0001pt; text-align: justify; text-justify: inter-ideograph;"><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">é€šè¿‡</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">proxy_pass</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">åŠŸèƒ½æŠŠç”¨æˆ·çš„æ¸…æ±‚è½¬å‘åˆ°åå‘ä»£ç†å®šä¹‰çš„</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">upstream</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">æœåŠ¡å™¨æ± </span></p>
</td>
</tr>
<tr>
<td style="width: 24.66%; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0cm 5.4pt;" width="24%">
<p class="MsoNormal" style="margin-bottom: .0001pt; text-align: justify; text-justify: inter-ideograph;"><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">proxy_set_header Host $host</span></p>
</td>
<td style="width: 75.34%; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: windowtext; border-right-width: 1pt; border-right-color: windowtext; padding: 0cm 5.4pt;" width="75%">
<p class="MsoNormal" style="margin-bottom: .0001pt; text-align: justify; text-justify: inter-ideograph;"><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">åœ¨ä»£ç†å‘åç«¯æœåŠ¡å™¨å‘é€çš„</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US"> http</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">è¯·æ±‚å¤´ä¸­åŠ å…¥</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US"> host</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">å­—æ®µä¿¡æ¯ï¼Œç”¨äºå½“åç«¯æœåŠ¡å™¨é…ç½®æœ‰å¤šä¸ªè™šæ‹Ÿä¸»æœºæ—¶ï¼Œå¯ä»¥è¯†åˆ«ä»£ç†çš„æ˜¯å“ªä¸ªè™šæ‹Ÿä¸»æœºã€‚è¿™æ˜¯èŠ‚ç‚¹æœåŠ¡å™¨å¤šè™šæ‹Ÿä¸»æœºæ—¶çš„å…³é”®é…ç½®</span></p>
</td>
</tr>
<tr>
<td style="width: 24.66%; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0cm 5.4pt;" width="24%">
<p class="MsoNormal" style="margin-bottom: .0001pt; text-align: justify; text-justify: inter-ideograph;"><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">proxy_set_header X-ForwardedFor</span></p>
<p class="MsoNormal" style="margin-bottom: .0001pt; text-align: justify; text-justify: inter-ideograph;"><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">$remote_addr;</span></p>
</td>
<td style="width: 75.34%; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: windowtext; border-right-width: 1pt; border-right-color: windowtext; padding: 0cm 5.4pt;" width="75%">
<p class="MsoNormal" style="margin-bottom: .0001pt; text-align: justify; text-justify: inter-ideograph;"><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">åœ¨ä»£ç†å‘åç«¯æœåŠ¡å™¨å‘é€çš„</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US"> http</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">è¯·æ±‚å¤´ä¸­åŠ å…¥</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US"> X-Forward-For</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">å­—æ®µä¿¡æ¯ï¼Œç”¨äºåç«¯æœåŠ¡å™¨ç¨‹åºã€æ—¥å¿—ç­‰æ¥æ”¶è®°å½•çœŸå®ç”¨æˆ·çš„</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US"> IP ,</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">è€Œä¸æ˜¯ä»£ç†æœåŠ¡å™¨çš„</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US"> IP</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">è¿™æ˜¯åå‘ä»£ç†æ—¶ï¼ŒèŠ‚ç‚¹æœåŠ¡å™¨è·å–ç”¨æˆ·çœŸå®</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US"> IP</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">çš„å¿…è¦åŠŸèƒ½é…ç½®</span></p>
</td>
</tr>
</tbody>
</table>
<h3>1.4.14 åå‘ä»£ç†æ’é”™æ€è·¯</h3>
<p><span style="font-size: 14px;">ã€€ã€€01.å…ˆåœ¨lb01ä¸Šè®¿é—®åç«¯èŠ‚ç‚¹è¿›è¡Œæµ‹è¯•</span></p>
<p>ã€€ã€€02.åœ¨lb01ä¸Šè®¿é—®æœ¬åœ°åœ°å€è¿›è¡Œæµ‹è¯•</p>
<p>ã€€ã€€03.åœ¨æµè§ˆå™¨ä¸Šè¿›è¡Œæµ‹è¯•</p>
<p>&nbsp;&nbsp;&nbsp;ã€€ã€€&nbsp;&nbsp;&nbsp;&nbsp; ç¼“å­˜ã€åŸŸåè§£æ</p>
<h3>1.4.15 proxy_next_uptream å‚æ•°</h3>
<p>ã€€ã€€å½“nginxæ¥æ”¶åç«¯æœåŠ¡å™¨è¿”å›proxy_next_upstream å‚æ•°å®šä¹‰çš„çŠ¶æ€ç æ—¶ï¼Œä¼šå°†è¿™ä¸ªè¯·æ±‚è½¬å‘ç»™æ­£å¸¸å·¥ä½œçš„åç«¯æœåŠ¡å™¨ï¼Œä¾‹å¦‚500ï¼Œ502ï¼Œ503ï¼Œ504ï¼Œæ­¤å‚æ•°å¯ä»¥æå‡ç”¨æˆ·çš„è®¿é—®ä½“éªŒã€‚</p>
<h2>1.5 å®šä¹‰å¤šä¸ªè™šæ‹Ÿä¸»æœºæ ‡ç­¾ä¿¡æ¯</h2>
<h3>1.5.1 proxy_set_header å‚æ•°</h3>
<p><strong>é…ç½®æ–‡ä»¶</strong></p>
<div>
<div class="cnblogs_code">
<pre>[<a href="email-protection.htm" tppabs="http://clsn.io/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="2755484853674b451716">[email&#160;protected]</a> conf]# <span style="color: #0000ff;">cat</span><span style="color: #000000;"> nginx.conf
worker_processes  </span><span style="color: #800080;">1</span><span style="color: #000000;">;
events {
    worker_connections  </span><span style="color: #800080;">1024</span><span style="color: #000000;">;
}
http {
    include       mime.types;
    default_type  application</span>/octet-<span style="color: #000000;">stream;
    sendfile        on;
    keepalive_timeout  </span><span style="color: #800080;">65</span><span style="color: #000000;">;
    upstream server_pools{
         server </span><span style="color: #800080;">10.0</span>.<span style="color: #800080;">0.7</span>:<span style="color: #800080;">80</span><span style="color: #000000;">;
         server </span><span style="color: #800080;">10.0</span>.<span style="color: #800080;">0.8</span>:<span style="color: #800080;">80</span><span style="color: #000000;">;
    }
    server{
       listen </span><span style="color: #800080;">80</span><span style="color: #000000;">;
       server_name bbs.etiantian.org;
       location </span>/<span style="color: #000000;"> {
          proxy_pass http:</span><span style="color: #008000;">//</span><span style="color: #008000;">server_pools;</span>
<span style="color: #000000;">              proxy_set_header Host $host;
       }
    }
    server{
       listen </span><span style="color: #800080;">80</span><span style="color: #000000;">;
       server_name www.etiantian.org;
       location </span>/<span style="color: #000000;"> {
          proxy_pass http:</span><span style="color: #008000;">//</span><span style="color: #008000;">server_pools;</span>
<span style="color: #000000;">               proxy_set_header Host $host;
       }
    }

}</span></pre>
</div>
</div>
<p><strong>è®¿é—®æŠ“åŒ…</strong></p>
<div>
<p class="a">&nbsp;&nbsp;&nbsp; è¯¥å‚æ•°åœ¨è´Ÿè½½æœåŠ¡å™¨åœ¨è®¿é—®åç«¯æœåŠ¡å™¨çš„æ—¶å€™ ä¼šå¸¦ä¸Šhostsä¿¡æ¯ã€‚</p>
</div>
<p align="center"><img data-original="http://clsn.io/wp-content/uploads/2018/03/1190037-20171217103232155-575135425.png" src="blank.gif" tppabs="http://clsn.io/wp-content/themes/clsn-003/img/blank.gif" alt="Nginxçš„åå‘ä»£ç†ä¸è´Ÿè½½å‡è¡¡" alt="" />&nbsp;</p>

<h3>1.5.2 X-Forwarded-For å‚æ•°</h3>
<p>ã€€ã€€<span style="background-color: #00ff00;">proxy_set_header X-Forwarded-For $remote_addr;</span></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ä»£ç†çš„å•¥æ—¶å€™åœ¨åé¢æ˜¾ç¤ºçœŸå®çš„IPåœ°å€</p>
<div>
<div class="cnblogs_code">
<pre>[<a href="email-protection.htm" tppabs="http://clsn.io/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="13617c7c67537f712322">[email&#160;protected]</a> conf]# <span style="color: #0000ff;">cat</span><span style="color: #000000;"> nginx.conf
worker_processes  </span><span style="color: #800080;">1</span><span style="color: #000000;">;
events {
    worker_connections  </span><span style="color: #800080;">1024</span><span style="color: #000000;">;
}
http {
    include       mime.types;
    default_type  application</span>/octet-<span style="color: #000000;">stream;
    sendfile        on;
    keepalive_timeout  </span><span style="color: #800080;">65</span><span style="color: #000000;">;
    upstream server_pools{
         server </span><span style="color: #800080;">10.0</span>.<span style="color: #800080;">0.8</span>:<span style="color: #800080;">80</span><span style="color: #000000;">;
         server </span><span style="color: #800080;">10.0</span>.<span style="color: #800080;">0.7</span>:<span style="color: #800080;">80</span><span style="color: #000000;">;
         server </span><span style="color: #800080;">10.0</span>.<span style="color: #800080;">0.9</span>:<span style="color: #800080;">80</span><span style="color: #000000;">;
    }
    server{
       listen </span><span style="color: #800080;">80</span><span style="color: #000000;">;
       server_name bbs.etiantian.org;
       location </span>/<span style="color: #000000;"> {
          proxy_pass http:</span><span style="color: #008000;">//</span><span style="color: #008000;">server_pools;</span>
<span style="color: #000000;">             proxy_set_header Host $host; 
          proxy_set_header X</span>-Forwarded-<span style="color: #000000;">For $remote_addr;
       }
    }
    server{
       listen </span><span style="color: #800080;">80</span><span style="color: #000000;">;
       server_name www.etiantian.org;
       location </span>/<span style="color: #000000;"> {
          proxy_pass http:</span><span style="color: #008000;">//</span><span style="color: #008000;">server_pools;</span>
<span style="color: #000000;">             proxy_set_header Host $host;
             proxy_set_header X</span>-Forwarded-<span style="color: #000000;">For $remote_addr;
       }
    }
    server{
       listen </span><span style="color: #800080;">80</span><span style="color: #000000;">;
       server_name blog.etiantian.org;
       location </span>/<span style="color: #000000;"> {
          proxy_pass http:</span><span style="color: #008000;">//</span><span style="color: #008000;">server_pools;</span>
<span style="color: #000000;">             proxy_set_header Host $host;
             proxy_set_header X</span>-Forwarded-<span style="color: #000000;">For $remote_addr;
       }
    }

}</span></pre>
</div>
</div>
<p><strong>å‚çœ‹æ—¥å¿—ä¿¡æ¯</strong></p>
<div>
<div class="cnblogs_code">
<pre><span style="color: #008080;">1</span> <span style="color: #800080;">10.0</span>.<span style="color: #800080;">0.5</span> - - [<span style="color: #800080;">30</span>/Oct/<span style="color: #800080;">2017</span>:<span style="color: #800080;">12</span>:<span style="color: #800080;">36</span>:<span style="color: #800080;">10</span> +<span style="color: #800080;">0800</span>] <span style="color: #800000;">"</span><span style="color: #800000;">GET / HTTP/1.0</span><span style="color: #800000;">"</span> <span style="color: #800080;">200</span> <span style="color: #800080;">10</span> <span style="color: #800000;">"</span><span style="color: #800000;">-</span><span style="color: #800000;">"</span> <span style="color: #800000;">"</span><span style="color: #800000;">Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/61.0.3163.100 Safari/537.36</span><span style="color: #800000;">"</span> <span style="color: #800000;">"</span><span style="color: #800000;">10.0.0.1</span><span style="color: #800000;">"</span>
<span style="color: #008080;">2</span> <span style="color: #800080;">10.0</span>.<span style="color: #800080;">0.5</span> - - [<span style="color: #800080;">30</span>/Oct/<span style="color: #800080;">2017</span>:<span style="color: #800080;">12</span>:<span style="color: #800080;">36</span>:<span style="color: #800080;">10</span> +<span style="color: #800080;">0800</span>] <span style="color: #800000;">"</span><span style="color: #800000;">GET /favicon.ico HTTP/1.0</span><span style="color: #800000;">"</span> <span style="color: #800080;">404</span> <span style="color: #800080;">571</span> <span style="color: #800000;">"</span><span style="color: #800000;">http://www.etiantian.org/</span><span style="color: #800000;">"</span> <span style="color: #800000;">"</span><span style="color: #800000;">Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/61.0.3163.100 Safari/537.36</span><span style="color: #800000;">"</span> <span style="color: #800000;">"</span><span style="color: #800000;">10.0.0.1</span><span style="color: #800000;">"</span></pre>
</div>
</div>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; è¯¥å‚æ•°é…ç½®ï¼Œä¼šåœ¨è®¿é—®æ—¥å¿—çš„åé¢åŠ ä¸ŠçœŸæ­£çš„è®¿é—®ç”¨æˆ·ip</p>
<h3>1.5.3 http proxy æ¨¡å—ç›¸å…³å‚æ•°è¯´æ˜</h3>
<table class="MsoTableGrid" style="width: 100%; border-width: initial; border-style: none; border-color: initial;" border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td style="width: 20.04%; border-width: 1pt; border-color: windowtext; background: #a6a6a6; padding: 0cm 5.4pt;" width="20%">
<p class="MsoNormal" style="margin-bottom: .0001pt; text-align: center;" align="center"><strong><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">http proxy </span></strong><strong><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">æ¨¡å—ç›¸å…³å‚æ•°</span></strong></p>
</td>
<td style="width: 79.96%; border-top-width: 1pt; border-right-width: 1pt; border-bottom-width: 1pt; border-top-color: windowtext; border-right-color: windowtext; border-bottom-color: windowtext; border-left: none; background: #a6a6a6; padding: 0cm 5.4pt;" width="79%">
<p class="MsoNormal" style="margin-bottom: .0001pt; text-align: center;" align="center"><strong><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">&nbsp;</span></strong><strong><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">è¯´æ˜</span></strong></p>
</td>
</tr>
<tr>
<td style="width: 20.04%; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0cm 5.4pt;" width="20%">
<p class="MsoNormal" style="margin-bottom: .0001pt; text-align: justify; text-justify: inter-ideograph;"><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">proxy_set_header</span></p>
</td>
<td style="width: 79.96%; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: windowtext; border-right-width: 1pt; border-right-color: windowtext; padding: 0cm 5.4pt;" width="79%">
<p class="MsoNormal" style="margin-bottom: .0001pt; text-align: justify; text-justify: inter-ideograph;"><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">è®¾ç½®</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">http</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">è¯·æ±‚</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">header</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">é¡¹ä¼ ç»™åç«¯æœåŠ¡å™¨èŠ‚ç‚¹ï¼Œä¾‹å¦‚ï¼šå¯å®ç°è®©ä»£ç†åç«¯çš„æœåŠ¡å™¨èŠ‚ç‚¹è·å–è®¿é—®å®¢æˆ·ç«¯ç”¨æˆ·çš„çœŸå®</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">IP</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">åœ°å€</span></p>
</td>
</tr>
<tr>
<td style="width: 20.04%; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0cm 5.4pt;" width="20%">
<p class="MsoNormal" style="margin-bottom: .0001pt; text-align: justify; text-justify: inter-ideograph;"><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">client_body_buffer_size</span></p>
</td>
<td style="width: 79.96%; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: windowtext; border-right-width: 1pt; border-right-color: windowtext; padding: 0cm 5.4pt;" width="79%">
<p class="MsoNormal" style="margin-bottom: .0001pt; text-align: justify; text-justify: inter-ideograph;"><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">ç”¨äºæŒ‡å®šå®¢æˆ·ç«¯è¯·æ±‚ä¸»ä½“ç¼“å†²åŒºå¤§å°</span></p>
</td>
</tr>
<tr>
<td style="width: 20.04%; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0cm 5.4pt;" width="20%">
<p class="MsoNormal" style="margin-bottom: .0001pt; text-align: justify; text-justify: inter-ideograph;"><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">proxy_connect_timeout</span></p>
</td>
<td style="width: 79.96%; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: windowtext; border-right-width: 1pt; border-right-color: windowtext; padding: 0cm 5.4pt;" width="79%">
<p class="MsoNormal" style="margin-bottom: .0001pt; text-align: justify; text-justify: inter-ideograph;"><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">è¡¨ç¤ºåå‘ä»£ç†åç«¯èŠ‚ç‚¹æœåŠ¡å™¨è¿æ¥çš„è¶…æ—¶æ—¶é—´ï¼Œå³å‘èµ·æ¡æ‰‹ç­‰å€™å“åº”çš„è¶…æ—¶æ—¶é—´</span></p>
</td>
</tr>
<tr>
<td style="width: 20.04%; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0cm 5.4pt;" width="20%">
<p class="MsoNormal" style="margin-bottom: .0001pt; text-align: justify; text-justify: inter-ideograph;"><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">proxy_send_timeout</span></p>
</td>
<td style="width: 79.96%; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: windowtext; border-right-width: 1pt; border-right-color: windowtext; padding: 0cm 5.4pt;" width="79%">
<p class="MsoNormal" style="margin-bottom: .0001pt; text-align: justify; text-justify: inter-ideograph;"><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">è¡¨ç¤ºä»£ç†åç«¯æœåŠ¡å™¨çš„æ•°æ®å›ä¼ æ—¶é—´ï¼Œå³åœ¨è§„å®šæ—¶é—´å†…åç«¯æœåŠ¡å™¨å¿…é¡»ä¼ å®Œæ‰€æœ‰æ•°æ®ï¼Œå¦åˆ™</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">nginx</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">å°†æ–­å¼€è¿™ä¸ªè¿æ¥</span></p>
</td>
</tr>
<tr>
<td style="width: 20.04%; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0cm 5.4pt;" width="20%">
<p class="MsoNormal" style="margin-bottom: .0001pt; text-align: justify; text-justify: inter-ideograph;"><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">proxy_read_timeout</span></p>
</td>
<td style="width: 79.96%; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: windowtext; border-right-width: 1pt; border-right-color: windowtext; padding: 0cm 5.4pt;" width="79%">
<p class="MsoNormal" style="margin-bottom: .0001pt; text-align: justify; text-justify: inter-ideograph;"><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">è®¾ç½®</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">nginx</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">ä»ä»£ç†çš„åç«¯æœåŠ¡å™¨è·å–ä¿¡æ¯çš„æ—¶é—´ï¼Œè¡¨ç¤ºè¿æ¥å»ºç«‹æˆåŠŸåï¼Œ</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">nginx</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">ç­‰å¾…åç«¯æœåŠ¡å™¨çš„å“åº”æ—¶é—´ï¼Œå…¶å®æ˜¯</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">nginx</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">å·²ç»è¿›å…¥åç«¯çš„æ’é˜Ÿä¹‹ä¸­ç­‰å€™å¤„ç†çš„æ—¶é—´</span></p>
</td>
</tr>
<tr>
<td style="width: 20.04%; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0cm 5.4pt;" width="20%">
<p class="MsoNormal" style="margin-bottom: .0001pt; text-align: justify; text-justify: inter-ideograph;"><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">proxy_buffer_size</span></p>
</td>
<td style="width: 79.96%; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: windowtext; border-right-width: 1pt; border-right-color: windowtext; padding: 0cm 5.4pt;" valign="top" width="79%">
<p class="MsoNormal" style="margin-bottom: .0001pt;"><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">è®¾ç½®ç¼“å†²åŒºå¤§å°ï¼Œé»˜è®¤è¯¥ç¼“å†²åŒºå¤§å°ç­‰äºæŒ‡ä»¤</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">proxy_buffers</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">è®¾ç½®çš„å¤§å°</span></p>
</td>
</tr>
<tr>
<td style="width: 20.04%; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0cm 5.4pt;" width="20%">
<p class="MsoNormal" style="margin-bottom: .0001pt; text-align: justify; text-justify: inter-ideograph;"><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">proxy_buffers</span></p>
</td>
<td style="width: 79.96%; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: windowtext; border-right-width: 1pt; border-right-color: windowtext; padding: 0cm 5.4pt;" width="79%">
<p class="MsoNormal" style="margin-bottom: .0001pt; text-align: justify; text-justify: inter-ideograph;"><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">è®¾ç½®ç¼“å†²åŒºçš„æ•°é‡å’Œå¤§å°ï¼Œ</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">nginx</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">ä»ä»£ç†çš„åç«¯æœåŠ¡å™¨è·å–çš„å“åº”ä¿¡æ¯ï¼Œä¼šè®¾ç½®åˆ°ç¼“å†²åŒº</span></p>
</td>
</tr>
<tr>
<td style="width: 20.04%; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0cm 5.4pt;" width="20%">
<p class="MsoNormal" style="margin-bottom: .0001pt; text-align: justify; text-justify: inter-ideograph;"><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">proxy_busy_buffers_size</span></p>
</td>
<td style="width: 79.96%; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: windowtext; border-right-width: 1pt; border-right-color: windowtext; padding: 0cm 5.4pt;" width="79%">
<p class="MsoNormal" style="margin-bottom: .0001pt; text-align: justify; text-justify: inter-ideograph;"><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">ç”¨äºè®¾ç½®ç›¸åŒå¾ˆå¿™æ—¶å¯ä»¥ä½¿ç”¨çš„</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">proxy_buffers</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">å¤§å°ï¼Œå®˜æ–¹æ¨èçš„å¤§å°ä¸º</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US"> proxy_buffers * 2</span></p>
</td>
</tr>
<tr>
<td style="width: 20.04%; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0cm 5.4pt;" width="20%">
<p class="MsoNormal" style="margin-bottom: .0001pt; text-align: justify; text-justify: inter-ideograph;"><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">proxy_trmp_file_write_size</span></p>
</td>
<td style="width: 79.96%; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: windowtext; border-right-width: 1pt; border-right-color: windowtext; padding: 0cm 5.4pt;" width="79%">
<p class="MsoNormal" style="margin-bottom: .0001pt; text-align: justify; text-justify: inter-ideograph;"><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">æŒ‡å®š</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">proxy</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">ç¼“å­˜ä¸´æ—¶æ–‡ä»¶çš„å¤§å°</span></p>
</td>
</tr>
</tbody>
</table>
<h2><span style="font-size: 1.17em;">1.6.1 ç›¸æ®URLç›®å½•åœ°å€è½¬å‘çš„åº”ç”¨åœºæ™¯</span>1.6 åŸºäºç›®å½•ï¼ˆuriï¼‰è¿›è¡Œè½¬å‘--ç½‘ç«™åŠ¨é™åˆ†ç¦»</h2>
<p>ã€€ã€€æ ¹æ®HTTPçš„URLè¿›è¡Œè½¬å‘çš„åº”ç”¨æƒ…å†µï¼Œè¢«ç§°ä¸ºç¬¬7å±‚ï¼ˆåº”ç”¨å±‚ï¼‰çš„è´Ÿè½½å‡è¡¡ï¼Œè€ŒLVSçš„è´Ÿè½½å‡è¡¡ä¸€èˆ¬ç”¨äºTCPç­‰çš„è½¬å‘ï¼Œå› æ­¤è¢«ç§°ä¸ºç¬¬4å±‚ï¼ˆä¼ è¾“å±‚ï¼‰çš„è´Ÿè½½å‡è¡¡ã€‚</p>
<p>ã€€ã€€åœ¨ä¼ä¸šä¸­ï¼Œæœ‰æ—¶å¸Œæœ›åªç”¨ä¸€ä¸ªåŸŸåå¯¹å¤–æä¾›æœåŠ¡ï¼Œä¸å¸Œæœ›ä½¿ç”¨å¤šä¸ªåŸŸåå¯¹åº”åŒä¸€ä¸ªäº§å“ä¸šåŠ¡ï¼Œæ­¤æ—¶å°±éœ€è¦åœ¨ä»£ç†æœåŠ¡å™¨ä¸Šé€šè¿‡é…ç½®è§„åˆ™ï¼Œä½¿å¾—åŒ¹é…ä¸åŒè§„åˆ™çš„è¯·æ±‚ä¼šäº¤ç»™ä¸åŒçš„æœåŠ¡å™¨æ± å¤„ç†ã€‚è¿™ç±»ä¸šåŠ¡æœ‰ï¼š</p>
<p>ã€€ã€€? ä¸šåŠ¡çš„åŸŸåæ²¡æœ‰æ‹†åˆ†æˆ–è€…ä¸å¸Œæœ›æ‹†åˆ†ï¼Œä½†å¸Œæœ›å®ç°åŠ¨é™åˆ†ç¦»ã€å¤šä¸šåŠ¡åˆ†ç¦»ï¼Œ</p>
<p>ã€€ã€€?&nbsp;ä¸åŒçš„å®¢æˆ·ç«¯è®¾å¤‡ï¼ˆä¾‹å¦‚ï¼šæ‰‹æœºå’Œ PCç«¯ï¼‰ä½¿ç”¨åŒä¸€ä¸ªåŸŸåè®¿é—®åŒä¸€ä¸ªä¸šåŠ¡ç½‘ç«™ï¼Œå°±éœ€è¦æ ¹ æ®è§„åˆ™å°†ä¸åŒè®¾å¤‡çš„ç”¨æˆ·è¯·æ±‚äº¤ç»™åç«¯ä¸åŒçš„æœåŠ¡å™¨å¤„ç†ï¼Œä»¥ä¾¿å¾—åˆ°æœ€ä½³ç”¨æˆ·ä½“éªŒã€‚</p>
<p style="text-align: center;">&nbsp;&nbsp;<img data-original="http://clsn.io/wp-content/uploads/2018/03/1190037-20171217103438604-1718117592.png" src="blank.gif" tppabs="http://clsn.io/wp-content/themes/clsn-003/img/blank.gif" alt="Nginxçš„åå‘ä»£ç†ä¸è´Ÿè½½å‡è¡¡" alt="" /></p>

<h3>1.6.2 ç¬¬ä¸€ä¸ªé‡Œç¨‹ç¢‘ï¼š æœåŠ¡å™¨è§„åˆ’</h3>
<div align="center">
<div align="center">
<table class="MsoTable15Grid4Accent5" style="border-width: initial; border-style: none; border-color: initial;" border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td style="width: 139.65pt; border-top-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-top-color: #4472c4; border-bottom-color: #4472c4; border-left-color: #4472c4; border-right: none; background: #4472c4; padding: 0cm 5.4pt;" valign="top" width="186">
<p class="MsoNormal" style="margin-bottom: .0001pt; mso-yfti-cnfc: 5;"><strong><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; color: white; mso-themecolor: background1;">ç›®å½•ï¼ˆ</span></strong><strong><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“; color: white; mso-themecolor: background1;" lang="EN-US">uri</span></strong><strong><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; color: white; mso-themecolor: background1;">ï¼‰</span></strong></p>
</td>
<td style="width: 130.45pt; border-top-width: 1pt; border-top-color: #4472c4; border-left: none; border-bottom-width: 1pt; border-bottom-color: #4472c4; border-right: none; background: #4472c4; padding: 0cm 5.4pt;" valign="top" width="174">
<p class="MsoNormal" style="margin-bottom: .0001pt; mso-yfti-cnfc: 1;"><strong><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“; color: white; mso-themecolor: background1;" lang="EN-US">ip</span></strong></p>
</td>
<td style="width: 126.35pt; border-top-width: 1pt; border-top-color: #4472c4; border-left: none; border-bottom-width: 1pt; border-bottom-color: #4472c4; border-right: none; background: #4472c4; padding: 0cm 5.4pt;" valign="top" width="168">
<p class="MsoNormal" style="margin-bottom: .0001pt; mso-yfti-cnfc: 1;"><strong><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; color: white; mso-themecolor: background1;">æœåŠ¡å™¨ç›®å½•</span></strong></p>
</td>
<td style="width: 126.35pt; border-top-width: 1pt; border-right-width: 1pt; border-bottom-width: 1pt; border-top-color: #4472c4; border-right-color: #4472c4; border-bottom-color: #4472c4; border-left: none; background: #4472c4; padding: 0cm 5.4pt;" valign="top" width="168">
<p class="MsoNormal" style="margin-bottom: .0001pt; mso-yfti-cnfc: 1;"><strong><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'; color: white; mso-themecolor: background1;">ç±»å‹</span></strong></p>
</td>
</tr>
<tr>
<td style="width: 139.65pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: #8eaadb; border-bottom-color: #8eaadb; border-left-color: #8eaadb; border-top: none; background: #d9e2f3; padding: 0cm 5.4pt;" valign="top" width="186">
<p class="MsoNormal" style="margin-bottom: .0001pt; mso-yfti-cnfc: 68;"><strong><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">/upload</span></strong></p>
</td>
<td style="width: 130.45pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: #8eaadb; border-right-width: 1pt; border-right-color: #8eaadb; background: #d9e2f3; padding: 0cm 5.4pt;" valign="top" width="174">
<p class="MsoNormal" style="margin-bottom: .0001pt; mso-yfti-cnfc: 64;"><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">10.0.0.8:80</span></p>
</td>
<td style="width: 126.35pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: #8eaadb; border-right-width: 1pt; border-right-color: #8eaadb; background: #d9e2f3; padding: 0cm 5.4pt;" valign="top" width="168">
<p class="MsoNormal" style="margin-bottom: .0001pt; mso-yfti-cnfc: 64;"><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">html/www/upload</span></p>
</td>
<td style="width: 126.35pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: #8eaadb; border-right-width: 1pt; border-right-color: #8eaadb; background: #d9e2f3; padding: 0cm 5.4pt;" valign="top" width="168">
<p class="MsoNormal" style="margin-bottom: .0001pt; mso-yfti-cnfc: 64;"><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">upload</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">æœåŠ¡å™¨</span></p>
</td>
</tr>
<tr>
<td style="width: 139.65pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: #8eaadb; border-bottom-color: #8eaadb; border-left-color: #8eaadb; border-top: none; padding: 0cm 5.4pt;" valign="top" width="186">
<p class="MsoNormal" style="margin-bottom: .0001pt; mso-yfti-cnfc: 4;"><strong><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">/static</span></strong></p>
</td>
<td style="width: 130.45pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: #8eaadb; border-right-width: 1pt; border-right-color: #8eaadb; padding: 0cm 5.4pt;" valign="top" width="174">
<p class="MsoNormal" style="margin-bottom: .0001pt;"><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">10.0.0.7:80</span></p>
</td>
<td style="width: 126.35pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: #8eaadb; border-right-width: 1pt; border-right-color: #8eaadb; padding: 0cm 5.4pt;" valign="top" width="168">
<p class="MsoNormal" style="margin-bottom: .0001pt;"><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">html/www/static</span></p>
</td>
<td style="width: 126.35pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: #8eaadb; border-right-width: 1pt; border-right-color: #8eaadb; padding: 0cm 5.4pt;" valign="top" width="168">
<p class="MsoNormal" style="margin-bottom: .0001pt;"><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">static</span><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">é™æ€æœåŠ¡å™¨</span></p>
</td>
</tr>
<tr>
<td style="width: 139.65pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: #8eaadb; border-bottom-color: #8eaadb; border-left-color: #8eaadb; border-top: none; background: #d9e2f3; padding: 0cm 5.4pt;" valign="top" width="186">
<p class="MsoNormal" style="margin-bottom: .0001pt; mso-yfti-cnfc: 68;"><strong><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">/</span></strong></p>
</td>
<td style="width: 130.45pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: #8eaadb; border-right-width: 1pt; border-right-color: #8eaadb; background: #d9e2f3; padding: 0cm 5.4pt;" valign="top" width="174">
<p class="MsoNormal" style="margin-bottom: .0001pt; mso-yfti-cnfc: 64;"><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">10.0.0.9:80</span></p>
</td>
<td style="width: 126.35pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: #8eaadb; border-right-width: 1pt; border-right-color: #8eaadb; background: #d9e2f3; padding: 0cm 5.4pt;" valign="top" width="168">
<p class="MsoNormal" style="margin-bottom: .0001pt; mso-yfti-cnfc: 64;"><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif; mso-fareast-font-family: å®‹ä½“;" lang="EN-US">html/www</span></p>
</td>
<td style="width: 126.35pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: #8eaadb; border-right-width: 1pt; border-right-color: #8eaadb; background: #d9e2f3; padding: 0cm 5.4pt;" valign="top" width="168">
<p class="MsoNormal" style="margin-bottom: .0001pt; mso-yfti-cnfc: 64;"><span style="font-size: 10.0pt; font-family: å®‹ä½“; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman';">é»˜è®¤</span></p>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<h3>1.6.3 ç¬¬äºŒä¸ªé‡Œç¨‹ç¢‘ï¼šåˆ›å»º/è®¾ç½®upstreamè´Ÿè½½ä¿¡æ¯</h3>
<div>
<div class="cnblogs_code">
<pre><span style="color: #000000;">upstream upload_pools {
  server </span><span style="color: #800080;">10.0</span>.<span style="color: #800080;">0.8</span>:<span style="color: #800080;">80</span><span style="color: #000000;">;
}
upstream static_pools {
  server </span><span style="color: #800080;">10.0</span>.<span style="color: #800080;">0.7</span>:<span style="color: #800080;">80</span><span style="color: #000000;">;
}
upstream default_pools {
  server </span><span style="color: #800080;">10.0</span>.<span style="color: #800080;">0.9</span>:<span style="color: #800080;">80</span><span style="color: #000000;">;
}</span></pre>
</div>
</div>
<h3>1.6.4 ç¬¬ä¸‰ä¸ªé‡Œç¨‹ç¢‘ï¼šå¦‚ä½•è°ƒç”¨upstreamä¿¡æ¯</h3>
<div>
<div class="cnblogs_code">
<pre>location /static/<span style="color: #000000;"> { 
    proxy_pass http:</span><span style="color: #008000;">//</span><span style="color: #008000;">static_pools;</span>
<span style="color: #000000;">    proxy_set_header Host $host;
    proxy_set_header X</span>-Forwarded-<span style="color: #000000;">For $remote_addr;
}
 location </span>/upload/<span style="color: #000000;"> { 
    proxy_pass http:</span><span style="color: #008000;">//</span><span style="color: #008000;">upload_pools;</span>
<span style="color: #000000;">    proxy_set_header Host $host;
    proxy_set_header X</span>-Forwarded-<span style="color: #000000;">For $remote_addr;
}
 location </span>/<span style="color: #000000;"> { 
    proxy_pass http:</span><span style="color: #008000;">//</span><span style="color: #008000;">default_pools;</span>
<span style="color: #000000;">    proxy_set_header Host $host;
    proxy_set_header X</span>-Forwarded-<span style="color: #000000;">For $remote_addr;
}</span></pre>
</div>
</div>
<h3>1.6.5 ç¬¬å››ä¸ªé‡Œç¨‹ç¢‘ï¼š ç¼–å†™é…ç½®æ–‡ä»¶lb01</h3>
<div>
<div class="cnblogs_code">
<pre>worker_processes  <span style="color: #800080;">1</span><span style="color: #000000;">;
events {
    worker_connections  </span><span style="color: #800080;">1024</span><span style="color: #000000;">;
}
http {
    include       mime.types;
    default_type  application</span>/octet-<span style="color: #000000;">stream;
    sendfile        on;
    keepalive_timeout  </span><span style="color: #800080;">65</span><span style="color: #000000;">;
    log_format  main  </span><span style="color: #800000;">'</span><span style="color: #800000;">$remote_addr - $remote_user [$time_local] "$request" </span><span style="color: #800000;">'</span>
                      <span style="color: #800000;">'</span><span style="color: #800000;">$status $body_bytes_sent "$http_referer" </span><span style="color: #800000;">'</span>
                      <span style="color: #800000;">'</span><span style="color: #800000;">"$http_user_agent" "$http_x_forwarded_for"</span><span style="color: #800000;">'</span><span style="color: #000000;">;                      
    upstream upload_pools {
      server </span><span style="color: #800080;">10.0</span>.<span style="color: #800080;">0.8</span>:<span style="color: #800080;">80</span><span style="color: #000000;">;
    }

    upstream static_pools {
      server </span><span style="color: #800080;">10.0</span>.<span style="color: #800080;">0.7</span>:<span style="color: #800080;">80</span><span style="color: #000000;">;
    }

    upstream default_pools {
      server </span><span style="color: #800080;">10.0</span>.<span style="color: #800080;">0.9</span>:<span style="color: #800080;">80</span><span style="color: #000000;">;
    }

    server {
        listen </span><span style="color: #800080;">80</span><span style="color: #000000;">;
        server_name www.etiantian.org;
    location </span>/static/<span style="color: #000000;"> { 
        proxy_pass http:</span><span style="color: #008000;">//</span><span style="color: #008000;">static_pools;</span>
<span style="color: #000000;">        proxy_set_header Host $host;
        proxy_set_header X</span>-Forwarded-<span style="color: #000000;">For $remote_addr;
    }

        location </span>/upload/<span style="color: #000000;"> { 
            proxy_pass http:</span><span style="color: #008000;">//</span><span style="color: #008000;">upload_pools;</span>
<span style="color: #000000;">        proxy_set_header Host $host;
        proxy_set_header X</span>-Forwarded-<span style="color: #000000;">For $remote_addr;
    }

     location </span>/<span style="color: #000000;"> { 
            proxy_pass http:</span><span style="color: #008000;">//</span><span style="color: #008000;">default_pools;</span>
<span style="color: #000000;">        proxy_set_header Host $host;
        proxy_set_header X</span>-Forwarded-<span style="color: #000000;">For $remote_addr;
    }
         access_log  logs</span>/<span style="color: #000000;">access_www.log  main;
    }
}</span></pre>
</div>
</div>
<h3>1.6.6 ç¬¬äº”ä¸ªé‡Œç¨‹ç¢‘ï¼š åˆ›å»ºç¯å¢ƒ</h3>
<div>
<div class="cnblogs_code">
<pre>www.etiantian.org/<span style="color: #000000;">xxx.html
www.etiantian.org</span>/upload/<span style="color: #000000;">xxx.html
www.etiantian.org</span>/static/xxx.html </pre>
</div>
</div>
<p>##web01</p>
<div>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">mkdir</span> -p /application/nginx/html/www/<span style="color: #000000;">upload
</span><span style="color: #0000ff;">echo</span>  <span style="color: #800000;">"</span><span style="color: #800000;">web01 upload</span><span style="color: #800000;">"</span> >/application/nginx/html/www/upload/xxx.html </pre>
</div>
</div>
<p>##web02</p>
<div>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">mkdir</span> -p /application/nginx/html/www/<span style="color: #000000;">static
</span><span style="color: #0000ff;">echo</span>  <span style="color: #800000;">"</span><span style="color: #800000;">web02 static</span><span style="color: #800000;">"</span> >/application/nginx/html/www/static/xxx.html </pre>
</div>
</div>
<p>##web03</p>
<div>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">echo</span>  <span style="color: #800000;">"</span><span style="color: #800000;">web03 default</span><span style="color: #800000;">"</span> >/application/nginx/html/www/xxx.html</pre>
</div>
</div>
<h3>1.6.7 ç¬¬å…­ä¸ªé‡Œç¨‹ç¢‘ï¼š è¿›è¡Œæµ‹è¯•</h3>
<div class="cnblogs_code">
<pre>[<a href="email-protection.htm" tppabs="http://clsn.io/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="394b56564d79555b0908">[email&#160;protected]</a> conf]# curl -H  host:www.etiantian.org  <span style="color: #800080;">10.0</span>.<span style="color: #800080;">0.5</span>/upload/<span style="color: #000000;">
web01 upload:</span>/application/nginx/html/www/<span style="color: #000000;">upload
[<a href="email-protection.htm" tppabs="http://clsn.io/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="a2d0cdcdd6e2cec09293">[email&#160;protected]</a> conf]# curl </span>-H  host:www.etiantian.org  <span style="color: #800080;">10.0</span>.<span style="color: #800080;">0.5</span>/static/<span style="color: #000000;">
web02,</span>/application/nginx/html/www/<span style="color: #000000;">static
[<a href="email-protection.htm" tppabs="http://clsn.io/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="0c7e6363784c606e3c3d">[email&#160;protected]</a> conf]# curl </span>-H  host:www.etiantian.org  <span style="color: #800080;">10.0</span>.<span style="color: #800080;">0.5</span>/<span style="color: #000000;">
web03 www</span></pre>
</div>
<p>æµè§ˆå™¨è¿›è¡Œè®¿é—®æµ‹è¯•</p>
<p align="center">&nbsp;<img src="1190037-20171217103639149-1325863413.png" tppabs="http://clsn.io/wp-content/uploads/2018/03/1190037-20171217103639149-1325863413.png" alt="Nginxçš„åå‘ä»£ç†ä¸è´Ÿè½½å‡è¡¡" alt="" /><img src="1190037-20171217103643054-1900020321.png" tppabs="http://clsn.io/wp-content/uploads/2018/03/1190037-20171217103643054-1900020321.png" alt="Nginxçš„åå‘ä»£ç†ä¸è´Ÿè½½å‡è¡¡" alt="" /><img data-original="http://clsn.io/wp-content/uploads/2018/03/1190037-20171217103646349-563920899.png" src="blank.gif" tppabs="http://clsn.io/wp-content/themes/clsn-003/img/blank.gif" alt="Nginxçš„åå‘ä»£ç†ä¸è´Ÿè½½å‡è¡¡" alt="" />&nbsp;</p>

<h2>1.7 æ ¹æ®å®¢æˆ·ç«¯çš„è®¾å¤‡å®ç°è½¬å‘ï¼ˆuser_agentï¼‰</h2>
<h3>1.7.1 user_agentçš„åº”ç”¨</h3>
<p align="center">&nbsp;<img data-original="http://clsn.io/wp-content/uploads/2018/03/1190037-20171217103720922-20796782.png" src="blank.gif" tppabs="http://clsn.io/wp-content/themes/clsn-003/img/blank.gif" alt="Nginxçš„åå‘ä»£ç†ä¸è´Ÿè½½å‡è¡¡" alt="" /></p>

<h3>1.7.2 ä¿®æ”¹lb01é…ç½®æ–‡ä»¶&nbsp;</h3>
<div>
<div class="cnblogs_code" onclick="cnblogs_code_show('a5fab604-162f-4ee1-b327-47a219d21cc2')"><img id="code_img_closed_a5fab604-162f-4ee1-b327-47a219d21cc2" class="code_img_closed" src="ContractedBlock-7.gif" tppabs="http://clsn.io/wp-content/uploads/2018/03/ContractedBlock-7.gif" alt="Nginxçš„åå‘ä»£ç†ä¸è´Ÿè½½å‡è¡¡" alt="" /><img id="code_img_opened_a5fab604-162f-4ee1-b327-47a219d21cc2" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('a5fab604-162f-4ee1-b327-47a219d21cc2',event)" data-original="http://clsn.io/wp-content/uploads/2018/03/ExpandedBlockStart-7.gif" src="blank.gif" tppabs="http://clsn.io/wp-content/themes/clsn-003/img/blank.gif" alt="Nginxçš„åå‘ä»£ç†ä¸è´Ÿè½½å‡è¡¡" alt="" /></p>

<div id="cnblogs_code_open_a5fab604-162f-4ee1-b327-47a219d21cc2" class="cnblogs_code_hide">
<pre><span style="color: #008080;"> 1</span> worker_processes  <span style="color: #800080;">1</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 2</span> <span style="color: #000000;">events {
</span><span style="color: #008080;"> 3</span>     worker_connections  <span style="color: #800080;">1024</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 4</span> <span style="color: #000000;">}
</span><span style="color: #008080;"> 5</span> <span style="color: #000000;">http {
</span><span style="color: #008080;"> 6</span> <span style="color: #000000;">    include       mime.types;
</span><span style="color: #008080;"> 7</span>     default_type  application/octet-<span style="color: #000000;">stream;
</span><span style="color: #008080;"> 8</span> <span style="color: #000000;">    sendfile        on;
</span><span style="color: #008080;"> 9</span>     keepalive_timeout  <span style="color: #800080;">65</span><span style="color: #000000;">;
</span><span style="color: #008080;">10</span>     log_format  main  <span style="color: #800000;">'</span><span style="color: #800000;">$remote_addr - $remote_user [$time_local] "$request" </span><span style="color: #800000;">'</span>
<span style="color: #008080;">11</span>                       <span style="color: #800000;">'</span><span style="color: #800000;">$status $body_bytes_sent "$http_referer" </span><span style="color: #800000;">'</span>
<span style="color: #008080;">12</span>                       <span style="color: #800000;">'</span><span style="color: #800000;">"$http_user_agent" "$http_x_forwarded_for"</span><span style="color: #800000;">'</span><span style="color: #000000;">;
</span><span style="color: #008080;">13</span>                                     
<span style="color: #008080;">14</span> <span style="color: #000000;">    upstream upload_pools {
</span><span style="color: #008080;">15</span>       server <span style="color: #800080;">10.0</span>.<span style="color: #800080;">0.8</span>:<span style="color: #800080;">80</span><span style="color: #000000;">;
</span><span style="color: #008080;">16</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">17</span> 
<span style="color: #008080;">18</span> <span style="color: #000000;">    upstream static_pools {
</span><span style="color: #008080;">19</span>       server <span style="color: #800080;">10.0</span>.<span style="color: #800080;">0.7</span>:<span style="color: #800080;">80</span><span style="color: #000000;">;
</span><span style="color: #008080;">20</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">21</span> 
<span style="color: #008080;">22</span> <span style="color: #000000;">    upstream default_pools {
</span><span style="color: #008080;">23</span>       server <span style="color: #800080;">10.0</span>.<span style="color: #800080;">0.9</span>:<span style="color: #800080;">80</span><span style="color: #000000;">;
</span><span style="color: #008080;">24</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">25</span> 
<span style="color: #008080;">26</span> <span style="color: #000000;">    server {
</span><span style="color: #008080;">27</span>         listen <span style="color: #800080;">80</span><span style="color: #000000;">;
</span><span style="color: #008080;">28</span> <span style="color: #000000;">        server_name www.etiantian.org;
</span><span style="color: #008080;">29</span>         location /<span style="color: #000000;"> {
</span><span style="color: #008080;">30</span>          <span style="color: #0000ff;">if</span> ($http_user_agent ~* <span style="color: #800000;">"</span><span style="color: #800000;">MSIE</span><span style="color: #800000;">"</span><span style="color: #000000;">)
</span><span style="color: #008080;">31</span> <span style="color: #000000;">          {
</span><span style="color: #008080;">32</span>             proxy_pass http:<span style="color: #008000;">//</span><span style="color: #008000;">static_pools;</span>
<span style="color: #008080;">33</span> <span style="color: #000000;">          }
</span><span style="color: #008080;">34</span>          <span style="color: #0000ff;">if</span> ($http_user_agent ~* <span style="color: #800000;">"</span><span style="color: #800000;">Chrome</span><span style="color: #800000;">"</span><span style="color: #000000;">)
</span><span style="color: #008080;">35</span> <span style="color: #000000;">          {
</span><span style="color: #008080;">36</span>             proxy_pass http:<span style="color: #008000;">//</span><span style="color: #008000;">upload_pools;</span>
<span style="color: #008080;">37</span> <span style="color: #000000;">          }
</span><span style="color: #008080;">38</span>         proxy_pass http:<span style="color: #008000;">//</span><span style="color: #008000;">default_pools;</span>
<span style="color: #008080;">39</span> <span style="color: #000000;">           proxy_set_header Host $host;
</span><span style="color: #008080;">40</span> <span style="color: #000000;">               }
</span><span style="color: #008080;">41</span>          access_log  logs/<span style="color: #000000;">access_www.log  main;
</span><span style="color: #008080;">42</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">43</span> }</pre>
</div>
<p><span class="cnblogs_code_collapse">View Code lb01é…ç½®æ–‡ä»¶</span></div>
</div>
<h3>1.7.3 è¿›è¡Œæµ‹è¯•</h3>
<div>
<p class="a">ã€€ã€€åŸºäºä¸Šä¸€æ­¥çš„æ“ä½œï¼Œç°åœ¨å¯ä»¥ä¹‹é—´çš„è¿›è¡Œè®¿é—®æµ‹è¯•</p>
</div>
<p>curl -A æŒ‡å®šè®¿é—®ç±»å‹</p>
<div>
<div class="cnblogs_code">
<pre>[<a href="email-protection.htm" tppabs="http://clsn.io/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="a2d0cdcdd6e2cec09293">[email&#160;protected]</a> conf]# curl -A MSIE -H host:www.etiantian.org <span style="color: #800080;">10.0</span>.<span style="color: #800080;">0.5</span><span style="color: #000000;">
web02 www
[<a href="email-protection.htm" tppabs="http://clsn.io/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="24564b4b506448461415">[email&#160;protected]</a> conf]# curl </span>-A Chrome -H host:www.etiantian.org <span style="color: #800080;">10.0</span>.<span style="color: #800080;">0.5</span><span style="color: #000000;">
web01 www
[<a href="email-protection.htm" tppabs="http://clsn.io/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="2e5c41415a6e424c1e1f">[email&#160;protected]</a> conf]# curl </span>-A xx -H host:www.etiantian.org <span style="color: #800080;">10.0</span>.<span style="color: #800080;">0.5</span><span style="color: #000000;">
web03 www</span></pre>
</div>
</div>
<h2>1.8 åˆ©ç”¨æ‰©å±•åè¿›è¡Œè½¬å‘</h2>
<p>åˆ©ç”¨åç¼€åè¿›è¡Œè½¬å‘ä¸nginxä¸­çš„åŸºäºåç¼€çš„è½¬è·³ä¸€æ ·å®ç°ã€‚</p>
<div>
<div class="cnblogs_code">
<pre>location ~.*.(gif|ipg|jpeg|png|bmp|swf|css|<span style="color: #000000;">js)$ {
        peoxy_pass http:</span><span style="color: #008000;">//</span><span style="color: #008000;">static_pools;</span>
<span style="color: #000000;">           include proxy.conf
}</span></pre>
</div>
<p style="text-align: right;">&nbsp;<strong>æœ¬æ–‡å‡ºè‡ª&ldquo;æƒ¨ç»¿å°‘å¹´&rdquo;ï¼Œæ¬¢è¿è½¬è½½ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼http://blog.znix.top</strong></p>
</div>
<p>&nbsp;</p>
  </div> <div class="s-weixin-one"> <div class="weimg-one"> <img src="clsn_linux.bmp" tppabs="http://clsn.io/wp-content/uploads/2018/09/clsn_linux.bmp" alt="weinxin" /> <div class="weixin-h"><strong>æƒ¨ç»¿å°‘å¹´Linux</strong></div> <div class="weixin-h-w">è¿™æ˜¯æˆ‘çš„å¾®ä¿¡å…¬ä¼—å·æ‰«ä¸€æ‰«</div> <div class="clear"></div> </div></div> <div class="clear"></div><div id="social"> <div class="social-main"> <span class="like"> <a href="javascript:;" data-action="ding" data-id="429" title="ç‚¹èµ" class="dingzan"><i class="be be-thumbs-up-o"></i>èµ <i class="count"> 0</i> </a> </span> <div class="shang-p"> <div class="shang-empty"><span></span></div> <span class="tipso_style" id="tip-p" data-tipso=' <span id="shang"> <span class="shang-main"> <h4><i class="be be-favorite" aria-hidden="true"></i> æ‚¨å¯ä»¥é€‰æ‹©ä¸€ç§æ–¹å¼èµåŠ©æœ¬ç«™</h4> <span class="clear"></span> </span> </span>'> <span class="shang-s"><a title="èµåŠ©æœ¬ç«™">èµ</a></span> </span> </div> <div class="share-sd"> <span class="share-s"><a href="javascript:void(0)" id="share-s" title="åˆ†äº«"><i class="be be-share"></i>åˆ†äº«</a></span> <div id="share"> <ul class="bdsharebuttonbox"> <li><a title="æ›´å¤š" class="bds_more be be-addbox" data-cmd="more" onclick="return false;" href="#"></a></li> <li><a title="åˆ†äº«åˆ°QQç©ºé—´" class="be be-qzone" data-cmd="qzone" onclick="return false;" href="#"></a></li> <li><a title="åˆ†äº«åˆ°æ–°æµªå¾®åš" class="be be-stsina" data-cmd="tsina" onclick="return false;" href="#"></a></li> <li><a title="åˆ†äº«åˆ°è…¾è®¯å¾®åš" class="be be-tqq" data-cmd="tqq" onclick="return false;" href="#"></a></li> <li><a title="åˆ†äº«åˆ°äººäººç½‘" class="be be-renren" data-cmd="renren" onclick="return false;" href="#"></a></li> <li><a title="åˆ†äº«åˆ°å¾®ä¿¡" class="be be-weixin" data-cmd="weixin" onclick="return false;" href="#"></a></li> </ul></div> </div> <div class="clear"></div> </div></div> <footer class="single-footer"> <ul id="fontsize"><li>A+</li></ul><div class="single-cat-tag"><div class="single-cat">æ‰€å±åˆ†ç±»ï¼š<a href="javascript:if(confirm('http://clsn.io/clsn-ops/linux%e8%bf%90%e7%bb%b4/  \n\nÎÄ¼ş²¢Î´ÒÀ Teleport Pro È¡»Ø£¬ÒòÎª ËüÎŞ·¨È¡µÃ£¬»òÖøËüÈ¡»Øºó·ÅÆú£¬»òÊÇÏîÄ¿Í£Ö¹µÄÌ«¿ì¡£  \n\nÄãÒª´Ó·şÎñÆ÷ÉÏ´ò¿ªËüÂğ£¿'))window.location='http://clsn.io/clsn-ops/linux%e8%bf%90%e7%bb%b4/'" tppabs="http://clsn.io/clsn-ops/linux%e8%bf%90%e7%bb%b4/" rel="category tag">Linuxè¿ç»´</a> <a href="index-3.htm" tppabs="http://clsn.io/clsn-ops/ops-linux/web-app/" rel="category tag">Webåº”ç”¨</a> <a href="index-15.htm" tppabs="http://clsn.io/clsn-ops/play-linux/" rel="category tag">ç©è½¬Linux</a> <a href="javascript:if(confirm('http://clsn.io/clsn-ops/ops-linux/  \n\nÎÄ¼ş²¢Î´ÒÀ Teleport Pro È¡»Ø£¬ÒòÎª ËüÎŞ·¨È¡µÃ£¬»òÖøËüÈ¡»Øºó·ÅÆú£¬»òÊÇÏîÄ¿Í£Ö¹µÄÌ«¿ì¡£  \n\nÄãÒª´Ó·şÎñÆ÷ÉÏ´ò¿ªËüÂğ£¿'))window.location='http://clsn.io/clsn-ops/ops-linux/'" tppabs="http://clsn.io/clsn-ops/ops-linux/" rel="category tag">è¿ç»´åŸºæœ¬åŠŸ</a></div></div> </footer><!-- .entry-footer --> <div class="clear"></div> </div><!-- .entry-content --> </article><!-- #post --><div class="single-tag"></div> <div class="authorbio wow fadeInUp" data-wow-delay="0.3s"> <img alt='' src="92aaa21455d7edf078accf7a7b75ee76-s=64&r=g&default=-wp-content-themes-clsn-003-img-avatar-96-latin_c.png" tppabs="https://cn.gravatar.com/avatar/92aaa21455d7edf078accf7a7b75ee76?s=64&r=g&default=%2Fwp-content%2Fthemes%2Fclsn-003%2Fimg%2Favatar%2F96%2Flatin_c.png" class='avatar avatar-64 photo wpfla ' width='64' height='64' /> <ul class="spostinfo"> <li> <li><strong>ç‰ˆæƒå£°æ˜ï¼š</strong>æœ¬ç«™åŸåˆ›æ–‡ç« ï¼Œäº2017å¹´12æœˆ17æ—¥<i class="i-time">02:40:00</i>ï¼Œç”± <b><a href="index-36.htm" tppabs="http://clsn.io/clsn/lxauthor/clsn/" title="ç”±æƒ¨ç»¿å°‘å¹´å‘å¸ƒ" rel="author">æƒ¨ç»¿å°‘å¹´</a></b> å‘è¡¨ï¼Œå…± 13585 å­—ã€‚</li> <li class="reprinted"><strong>è½¬è½½è¯·æ³¨æ˜ï¼š</strong><a href="lx429.html" tppabs="http://clsn.io/clsn/lx429.html" rel="bookmark" title="æœ¬æ–‡å›ºå®šé“¾æ¥ http://clsn.io/clsn/lx429.html">Nginxçš„åå‘ä»£ç†ä¸è´Ÿè½½å‡è¡¡ | æƒ¨ç»¿å°‘å¹´</a></li> </ul> <div class="clear"></div></div> <div id="related-img" class="wow fadeInUp" data-wow-delay="0.3s"> <div class="r4"> <div class="related-site"> <figure class="related-site-img"> <span class="load"><a href="javascript:if(confirm('http://clsn.io/clsn/lx1086.html  \n\nÎÄ¼ş²¢Î´ÒÀ Teleport Pro È¡»Ø£¬ÒòÎª ËüÎŞ·¨È¡µÃ£¬»òÖøËüÈ¡»Øºó·ÅÆú£¬»òÊÇÏîÄ¿Í£Ö¹µÄÌ«¿ì¡£  \n\nÄãÒª´Ó·şÎñÆ÷ÉÏ´ò¿ªËüÂğ£¿'))window.location='http://clsn.io/clsn/lx1086.html'" tppabs="http://clsn.io/clsn/lx1086.html"><img src="loading.png" tppabs="http://clsn.io/wp-content/themes/clsn-003/img/loading.png" data-original="/wp-content/themes/clsn-003/timthumb.php?src=/wp-content/uploads/2018/09/1190037-20180205204316029-486521233.png&w=280&h=210&a=&zc=1" alt="AWKå¸¸ç”¨æŠ€å·§" /></a></span> </figure> <div class="related-title"><a href="javascript:if(confirm('http://clsn.io/clsn/lx1086.html  \n\nÎÄ¼ş²¢Î´ÒÀ Teleport Pro È¡»Ø£¬ÒòÎª ËüÎŞ·¨È¡µÃ£¬»òÖøËüÈ¡»Øºó·ÅÆú£¬»òÊÇÏîÄ¿Í£Ö¹µÄÌ«¿ì¡£  \n\nÄãÒª´Ó·şÎñÆ÷ÉÏ´ò¿ªËüÂğ£¿'))window.location='http://clsn.io/clsn/lx1086.html'" tppabs="http://clsn.io/clsn/lx1086.html">AWKå¸¸ç”¨æŠ€å·§</a></div> </div> </div> <div class="r4"> <div class="related-site"> <figure class="related-site-img"> <span class="load"><a href="lx1088.html" tppabs="http://clsn.io/clsn/lx1088.html"><img src="loading.png" tppabs="http://clsn.io/wp-content/themes/clsn-003/img/loading.png" data-original="/wp-content/themes/clsn-003/timthumb.php?src=/wp-content/uploads/2018/09/1190037-20180612203730808-1316825229.png&w=280&h=210&a=&zc=1" alt="Webç¼“å­˜çŸ¥è¯†ä½“ç³»" /></a></span> </figure> <div class="related-title"><a href="lx1088.html" tppabs="http://clsn.io/clsn/lx1088.html">Webç¼“å­˜çŸ¥è¯†ä½“ç³»</a></div> </div> </div> <div class="r4"> <div class="related-site"> <figure class="related-site-img"> <span class="load"><a href="lx1090.html" tppabs="http://clsn.io/clsn/lx1090.html"><img src="loading.png" tppabs="http://clsn.io/wp-content/themes/clsn-003/img/loading.png" data-original="/wp-content/themes/clsn-003/timthumb.php?src=/wp-content/uploads/2018/09/1190037-20180604214121023-576776588.png&w=280&h=210&a=&zc=1" alt="ç›‘æ§å‘½ä»¤ä¹‹tsar" /></a></span> </figure> <div class="related-title"><a href="lx1090.html" tppabs="http://clsn.io/clsn/lx1090.html">ç›‘æ§å‘½ä»¤ä¹‹tsar</a></div> </div> </div> <div class="r4"> <div class="related-site"> <figure class="related-site-img"> <span class="load"><a href="javascript:if(confirm('http://clsn.io/clsn/lx1092.html  \n\nÎÄ¼ş²¢Î´ÒÀ Teleport Pro È¡»Ø£¬ÒòÎª ËüÎŞ·¨È¡µÃ£¬»òÖøËüÈ¡»Øºó·ÅÆú£¬»òÊÇÏîÄ¿Í£Ö¹µÄÌ«¿ì¡£  \n\nÄãÒª´Ó·şÎñÆ÷ÉÏ´ò¿ªËüÂğ£¿'))window.location='http://clsn.io/clsn/lx1092.html'" tppabs="http://clsn.io/clsn/lx1092.html"><img src="loading.png" tppabs="http://clsn.io/wp-content/themes/clsn-003/img/loading.png" data-original="/wp-content/themes/clsn-003/img/random/20.jpg" alt="æ—¥å¿—åˆ‡å‰²ä¹‹Logrotate" /></a></span> </figure> <div class="related-title"><a href="javascript:if(confirm('http://clsn.io/clsn/lx1092.html  \n\nÎÄ¼ş²¢Î´ÒÀ Teleport Pro È¡»Ø£¬ÒòÎª ËüÎŞ·¨È¡µÃ£¬»òÖøËüÈ¡»Øºó·ÅÆú£¬»òÊÇÏîÄ¿Í£Ö¹µÄÌ«¿ì¡£  \n\nÄãÒª´Ó·şÎñÆ÷ÉÏ´ò¿ªËüÂğ£¿'))window.location='http://clsn.io/clsn/lx1092.html'" tppabs="http://clsn.io/clsn/lx1092.html">æ—¥å¿—åˆ‡å‰²ä¹‹Logrotate</a></div> </div> </div> <div class="clear"></div></div> <div id="single-widget"> <div class="wow fadeInUp" data-wow-delay="0.3s"> <aside id="feed-2" class="widget feed wow fadeInUp" data-wow-delay="0.3s"><h3 class="widget-title"><span class="s-icon"></span>å…³æ³¨æˆ‘ä»¬</h3><div id="feed_widget"> <div class="feed-rss"> <ul> <li class="weixin"> <span class="tipso_style" id="tip-w-j" data-tipso='<span class="weixin-qr"><img src="clsn_linux.bmp" tppabs="http://clsn.io/wp-content/uploads/2018/09/clsn_linux.bmp" alt="weixin"/></span>'><a title="å¾®ä¿¡"><i class="be be-weixin"></i></a></span> </li> <li class="feed"><a title="è®¢é˜…" href="index-23.htm" tppabs="http://clsn.io/feed/" target="_blank" rel="external nofollow"><i class="be be-rss"></i></a></li> <li class="tsina"><a title="" href="javascript:if(confirm('https://weibo.com/236567300  \n\nÎÄ¼ş²¢Î´ÒÀ Teleport Pro È¡»Ø£¬ÒòÎª ´ËÒ»µØÖ·Ê¹ÓÃÉĞÎ´Ö§³ÖµÄĞ­Òé (ÀıÈç£¬gopher)¡£  \n\nÄãÒª´Ó·şÎñÆ÷ÉÏ´ò¿ªËüÂğ£¿'))window.location='https://weibo.com/236567300'" tppabs="https://weibo.com/236567300" target="_blank" rel="external nofollow"><i class="be be-stsina"></i></a></li> <li class="tqq"><a title="" href="javascript:if(confirm('https://weibo.com/236567300  \n\nÎÄ¼ş²¢Î´ÒÀ Teleport Pro È¡»Ø£¬ÒòÎª ´ËÒ»µØÖ·Ê¹ÓÃÉĞÎ´Ö§³ÖµÄĞ­Òé (ÀıÈç£¬gopher)¡£  \n\nÄãÒª´Ó·şÎñÆ÷ÉÏ´ò¿ªËüÂğ£¿'))window.location='https://weibo.com/236567300'" tppabs="https://weibo.com/236567300" target="_blank" rel="external nofollow"><i class="be be-tqq"></i></a></li> </ul> </div></div><div class="clear"></div></aside><aside id="related_post-2" class="widget related_post wow fadeInUp" data-wow-delay="0.3s"><div id="related_post_widget"> <ul> <li><a href="javascript:if(confirm('http://clsn.io/clsn/lx1086.html  \n\nÎÄ¼ş²¢Î´ÒÀ Teleport Pro È¡»Ø£¬ÒòÎª ËüÎŞ·¨È¡µÃ£¬»òÖøËüÈ¡»Øºó·ÅÆú£¬»òÊÇÏîÄ¿Í£Ö¹µÄÌ«¿ì¡£  \n\nÄãÒª´Ó·şÎñÆ÷ÉÏ´ò¿ªËüÂğ£¿'))window.location='http://clsn.io/clsn/lx1086.html'" tppabs="http://clsn.io/clsn/lx1086.html">AWKå¸¸ç”¨æŠ€å·§</a></li> <li><a href="lx1088.html" tppabs="http://clsn.io/clsn/lx1088.html">Webç¼“å­˜çŸ¥è¯†ä½“ç³»</a></li> <li><a href="lx1090.html" tppabs="http://clsn.io/clsn/lx1090.html">ç›‘æ§å‘½ä»¤ä¹‹tsar</a></li> </ul></div><div class="clear"></div></aside> </div> <div class="clear"></div></div> <nav class="nav-single wow fadeInUp" data-wow-delay="0.3s"> <a href="lx442.html" tppabs="http://clsn.io/clsn/lx442.html" rel="prev"><span class="meta-nav"><span class="post-nav"><i class="be be-arrowleft"></i> ä¸Šä¸€ç¯‡</span><br/>MySQLç”¨æˆ·ç®¡ç†åŠSQLè¯­å¥è¯¦è§£</span></a><a href="lx427.html" tppabs="http://clsn.io/clsn/lx427.html" rel="next"><span class="meta-nav"><span class="post-nav">ä¸‹ä¸€ç¯‡ <i class="be be-arrowright"></i></span><br/>keepalivedå®ç°æœåŠ¡é«˜å¯ç”¨</span></a> <div class="clear"></div> </nav> <nav class="navigation post-navigation" role="navigation"> <h2 class="screen-reader-text">æ–‡ç« å¯¼èˆª</h2> <div class="nav-links"><div class="nav-previous"><a href="lx442.html" tppabs="http://clsn.io/clsn/lx442.html" rel="prev"><span class="meta-nav-r" aria-hidden="true"><i class="be be-arrowleft"></i></span></a></div><div class="nav-next"><a href="lx427.html" tppabs="http://clsn.io/clsn/lx427.html" rel="next"><span class="meta-nav-l" aria-hidden="true"><i class="be be-arrowright"></i></span></a></div></div> </nav> <!-- å¼•ç”¨ --><div class="scroll-comments"></div><div id="comments" class="comments-area"> <div id="respond" class="comment-respond wow fadeInUp" data-wow-delay="0.3s"> <h3 id="reply-title" class="comment-reply-title"><span>å‘è¡¨è¯„è®º</span><small><a rel="nofollow" id="cancel-comment-reply-link" href="lx429.html#respond" tppabs="http://clsn.io/clsn/lx429.html#respond" style="display:none;">å–æ¶ˆå›å¤</a></small></h3> <form action="http://clsn.io/wp-comments-post.php" method="post" id="commentform"> <p class="emoji-box"><script data-cfasync="false" src="email-decode.min.js" tppabs="http://clsn.io/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script type="text/javascript">/* <![CDATA[ */ function grin(tag) { var myField; tag = ' ' + tag + ' '; if (document.getElementById('comment') && document.getElementById('comment').type == 'textarea') { myField = document.getElementById('comment'); } else { return false; } if (document.selection) { myField.focus(); sel = document.selection.createRange(); sel.text = tag; myField.focus(); } else if (myField.selectionStart || myField.selectionStart == '0') { var startPos = myField.selectionStart; var endPos = myField.selectionEnd; var cursorPos = endPos; myField.value = myField.value.substring(0, startPos) + tag + myField.value.substring(endPos, myField.value.length); cursorPos += tag.length; myField.focus(); myField.selectionStart = cursorPos; myField.selectionEnd = cursorPos; } else { myField.value += tag; myField.focus(); } }/* ]]> */</script><a href="javascript:grin(':?:')"><img src="icon_question.gif" tppabs="http://clsn.io/wp-content/themes/clsn-003/img/smilies/icon_question.gif" alt=":?:" title="ç–‘é—®" /></a><a href="javascript:grin(':razz:')"><img src="icon_razz.gif" tppabs="http://clsn.io/wp-content/themes/clsn-003/img/smilies/icon_razz.gif" alt=":razz:" title="è°ƒçš®" /></a><a href="javascript:grin(':sad:')"><img src="icon_sad.gif" tppabs="http://clsn.io/wp-content/themes/clsn-003/img/smilies/icon_sad.gif" alt=":sad:" title="éš¾è¿‡" /></a><a href="javascript:grin(':evil:')"><img src="icon_evil.gif" tppabs="http://clsn.io/wp-content/themes/clsn-003/img/smilies/icon_evil.gif" alt=":evil:" title="æŠ é¼»" /></a><a href="javascript:grin(':!:')"><img src="icon_exclaim.gif" tppabs="http://clsn.io/wp-content/themes/clsn-003/img/smilies/icon_exclaim.gif" alt=":!:" title="å“" /></a><a href="javascript:grin(':smile:')"><img src="icon_smile.gif" tppabs="http://clsn.io/wp-content/themes/clsn-003/img/smilies/icon_smile.gif" alt=":smile:" title="å¾®ç¬‘" /></a><a href="javascript:grin(':oops:')"><img src="icon_redface.gif" tppabs="http://clsn.io/wp-content/themes/clsn-003/img/smilies/icon_redface.gif" alt=":oops:" title="æ†¨ç¬‘" /></a><a href="javascript:grin(':grin:')"><img src="icon_biggrin.gif" tppabs="http://clsn.io/wp-content/themes/clsn-003/img/smilies/icon_biggrin.gif" alt=":grin:" title="åç¬‘" /></a><a href="javascript:grin(':eek:')"><img src="icon_surprised.gif" tppabs="http://clsn.io/wp-content/themes/clsn-003/img/smilies/icon_surprised.gif" alt=":eek:" title="æƒŠè®¶" /></a><a href="javascript:grin(':shock:')"><img src="icon_eek.gif" tppabs="http://clsn.io/wp-content/themes/clsn-003/img/smilies/icon_eek.gif" alt=":shock:" title="å‘å‘†" /></a><a href="javascript:grin(':???:')"><img src="icon_confused.gif" tppabs="http://clsn.io/wp-content/themes/clsn-003/img/smilies/icon_confused.gif" alt=":???:" title="æ’‡å˜´" /></a><a href="javascript:grin(':cool:')"><img src="icon_cool.gif" tppabs="http://clsn.io/wp-content/themes/clsn-003/img/smilies/icon_cool.gif" alt=":cool:" title="å¤§å…µ" /></a><a href="javascript:grin(':lol:')"><img src="icon_lol.gif" tppabs="http://clsn.io/wp-content/themes/clsn-003/img/smilies/icon_lol.gif" alt=":lol:" title="å·ç¬‘" /></a><a href="javascript:grin(':mad:')"><img src="icon_mad.gif" tppabs="http://clsn.io/wp-content/themes/clsn-003/img/smilies/icon_mad.gif" alt=":mad:" title="å’’éª‚" /></a><a href="javascript:grin(':twisted:')"><img src="icon_twisted.gif" tppabs="http://clsn.io/wp-content/themes/clsn-003/img/smilies/icon_twisted.gif" alt=":twisted:" title="å‘æ€’" /></a><a href="javascript:grin(':roll:')"><img src="icon_rolleyes.gif" tppabs="http://clsn.io/wp-content/themes/clsn-003/img/smilies/icon_rolleyes.gif" alt=":roll:" title="ç™½çœ¼" /></a><a href="javascript:grin(':wink:')"><img src="icon_wink.gif" tppabs="http://clsn.io/wp-content/themes/clsn-003/img/smilies/icon_wink.gif" alt=":wink:" title="é¼“æŒ" /></a><a href="javascript:grin(':idea:')"><img src="icon_idea.gif" tppabs="http://clsn.io/wp-content/themes/clsn-003/img/smilies/icon_idea.gif" alt=":idea:" title="é…·" /></a><a href="javascript:grin(':arrow:')"><img src="icon_arrow.gif" tppabs="http://clsn.io/wp-content/themes/clsn-003/img/smilies/icon_arrow.gif" alt=":arrow:" title="æ“¦æ±—" /></a><a href="javascript:grin(':neutral:')"><img src="icon_neutral.gif" tppabs="http://clsn.io/wp-content/themes/clsn-003/img/smilies/icon_neutral.gif" alt=":neutral:" title="äº²äº²" /></a><a href="javascript:grin(':cry:')"><img src="icon_cry.gif" tppabs="http://clsn.io/wp-content/themes/clsn-003/img/smilies/icon_cry.gif" alt=":cry:" title="å¤§å“­" /></a><a href="javascript:grin(':mrgreen:')"><img src="icon_mrgreen.gif" tppabs="http://clsn.io/wp-content/themes/clsn-003/img/smilies/icon_mrgreen.gif" alt=":mrgreen:" title="å‘²ç‰™" /></a><br /></p> <p class="comment-form-comment"><textarea id="comment" name="comment" rows="4" tabindex="1"></textarea></p> <p class="comment-tool"> <a class="tool-img" href='javascript:embedImage();' title="æ’å…¥å›¾ç‰‡"><i class="icon-img"></i><i class="be be-picture"></i></a> <a class="emoji" href="" title="æ’å…¥è¡¨æƒ…"><i class="be be-insertemoticon"></i></a> </p> <div id="comment-author-info"> <p class="comment-form-author"> <label for="author">æ˜µç§°<span class="required">*</span></label> <input type="text" name="author" id="author" class="commenttext" value="" tabindex="2" /> </p> <p class="comment-form-email"> <label for="email">é‚®ç®±<span class="required">*</span></label> <input type="text" name="email" id="email" class="commenttext" value="" tabindex="3" /> </p> <p class="comment-form-url"> <label for="url">ç½‘å€</label> <input type="text" name="url" id="url" class="commenttext" value="" tabindex="4" /> </p> </div> <div class="qaptcha"></div> <div class="clear"></div> <p class="form-submit"> <input id="submit" name="submit" type="submit" tabindex="5" value="æäº¤è¯„è®º"/> <input type='hidden' name='comment_post_ID' value='429' id='comment_post_ID' /><input type='hidden' name='comment_parent' id='comment_parent' value='0' /> </p> <span class="mail-notify"> <input type="checkbox" name="comment_mail_notify" id="comment_mail_notify" class="notify" value="comment_mail_notify" /> <label for="comment_mail_notify"><span>æœ‰å›å¤æ—¶é‚®ä»¶é€šçŸ¥æˆ‘</span></label> </span> </form> </div> </div><!-- #comments --> </main><!-- .site-main --> </div><!-- .content-area --><div id="sidebar" class="widget-area all-sidebar"> <aside id="search-3" class="widget widget_search wow fadeInUp" data-wow-delay="0.3s"><h3 class="widget-title"><span class="title-i"><span class="title-i-t"></span><span class="title-i-b"></span><span class="title-i-b"></span><span class="title-i-t"></span></span>å…¨ç«™æœç´¢</h3><div class="searchbar"> <form method="get" id="searchform" action="http://clsn.io/"> <span class="search-input"> <input type="text" value="" name="s" id="s" placeholder="è¾“å…¥æœç´¢å†…å®¹" required /> <button type="submit" id="searchsubmit"><i class="be be-search"></i></button> </span> </form></div><div class="clear"></div></aside><aside id="random_post-2" class="widget random_post wow fadeInUp" data-wow-delay="0.3s"><h3 class="widget-title"><span class="title-i"><span class="title-i-t"></span><span class="title-i-b"></span><span class="title-i-b"></span><span class="title-i-t"></span></span>çƒ­ç‚¹æ–‡ç« </h3><div id="random_post_widget"> <ul> <li><a href="lx891.html" tppabs="http://clsn.io/clsn/lx891.html" rel="bookmark">FPMå®šåˆ¶RPMåŒ…å®è·µ</a></li> <li><a href="lx766.html" tppabs="http://clsn.io/clsn/lx766.html" rel="bookmark">ç”¨æˆ·ç®¡ç†ä¸‹</a></li> <li><a href="lx194.html" tppabs="http://clsn.io/clsn/lx194.html" rel="bookmark">KVM è™šæ‹ŸåŒ–æŠ€æœ¯</a></li> <li><a href="lx949.html" tppabs="http://clsn.io/clsn/lx949.html" rel="bookmark">TCP/IP åè®®ç°‡ ç«¯å£ ä¸‰æ¬¡æ¡æ‰‹ å››æ¬¡æŒ¥æ‰‹ 11ç§çŠ¶æ€é›†</a></li> <li><a href="lx920.html" tppabs="http://clsn.io/clsn/lx920.html" rel="bookmark">rsync æœåŠ¡éƒ¨ç½²è¯¦è§£</a></li> <li><a href="lx31.html" tppabs="http://clsn.io/clsn/lx31.html" rel="bookmark">Docker å®¹å™¨å…¥é—¨</a></li> <li><a href="lx966.html" tppabs="http://clsn.io/clsn/lx966.html" rel="bookmark">ä¼ä¸šæ¶æ„è§„åˆ’åŠæœåŠ¡å™¨ä¼˜åŒ–å‚æ•°</a></li> <li><a href="lx854.html" tppabs="http://clsn.io/clsn/lx854.html" rel="bookmark">å…¨ç«™HTTPSç®€å•å®è·µ</a></li> <li><a href="lx46.html" tppabs="http://clsn.io/clsn/lx46.html" rel="bookmark">Redis æ•°æ®åº“</a></li> <li><a href="lx797.html" tppabs="http://clsn.io/clsn/lx797.html" rel="bookmark">kickstartæ¨¡å¼å®ç°æ‰¹é‡å®‰è£…centos7.xç³»ç»Ÿ</a></li> </ul></div><div class="clear"></div></aside> </div><div class="clear"></div> </div><!-- .site-content --> <div class="clear"></div> <footer id="colophon" class="site-footer" role="contentinfo"> <div class="site-info"> Copyright Â©Â 2018Â <a href="index.htm" tppabs="http://clsn.io/">æƒ¨ç»¿å°‘å¹´</a>Â Â ç‰ˆæƒæ‰€æœ‰ <span class="add-info"> </span> </div><!-- .site-info --> </footer><!-- .site-footer --><div id="login"> <div id="login-tab" class="login-tab-product"> <h2 class="login-tab-hd"> <span class="login-tab-hd-con"><a href="javascript:">ç™»å½•</a></span> <span class="login-tab-hd-con"><a href="javascript:">æ³¨å†Œ</a></span> <span class="login-tab-hd-con"><a href="javascript:">æ‰¾å›å¯†ç </a></span> </h2> <div class="login-tab-bd login-dom-display"> <div class="login-tab-bd-con login-current"> <div id="tab1_login" class="tab_content_login"> <form method="post" action="http://clsn.io/wp-login.php" class="wp-user-form"> <div class="username"> <label for="user_login">ç”¨æˆ·å</label> <input type="text" name="log" value="" size="20" id="user_login" tabindex="11" /> </div> <div class="password"> <label for="user_pass">å¯†ç </label> <input type="password" name="pwd" value="" size="20" id="user_pass" tabindex="12" /> </div> <div class="login-form"></div> <div class="login_fields"> <div class="rememberme"> <label for="rememberme"> <input type="checkbox" name="rememberme" value="forever" checked="checked" id="rememberme" tabindex="13" />è®°ä½æˆ‘çš„ç™»å½•ä¿¡æ¯ </label> </div> <input type="submit" name="user-submit" value="ç™»å½•" tabindex="14" class="user-submit" /> <input type="hidden" name="redirect_to" value="/clsn/lx429.html" /> <input type="hidden" name="user-cookie" value="1" /> </div> </form> </div> </div> <div class="login-tab-bd-con"> <div id="tab2_login" class="tab_content_login"> <form method="post" action="http://clsn.io/wp-login.php?action=register" class="wp-user-form"> <div class="username"> <label for="user_login">ç”¨æˆ·å</label> <input type="text" name="user_login" value="" size="20" id="user_login" tabindex="101" /> </div> <div class="password"> <label for="user_email">ç”µå­é‚®ä»¶åœ°å€</label> <input type="text" name="user_email" value="" size="25" id="user_email" tabindex="102" /> </div> <div class="login_fields"> <input type="submit" name="user-submit" value="æ³¨å†Œ" class="user-submit" tabindex="103" /> <input type="hidden" name="redirect_to" value="/clsn/lx429.html?register=true" /> <input type="hidden" name="user-cookie" value="1" /> </div> </form> </div> </div> <div class="login-tab-bd-con"> <div id="tab3_login" class="tab_content_login"> <p class="message">è¾“å…¥ç”¨æˆ·åæˆ–ç”µå­é‚®ç®±åœ°å€ï¼Œæ‚¨ä¼šæ”¶åˆ°ä¸€å°æ–°å¯†ç é“¾æ¥çš„ç”µå­é‚®ä»¶ã€‚</p> <form method="post" action="http://clsn.io/wp-login.php?action=lostpassword" class="wp-user-form"> <div class="username"> <label for="user_login" class="hide">ç”¨æˆ·åæˆ–ç”µå­é‚®ä»¶åœ°å€</label> <input type="text" name="user_login" value="" size="20" id="user_login" tabindex="1001" /> </div> <div class="login_fields"> <div class="login-form"></div> <input type="submit" name="user-submit" value="è·å–æ–°å¯†ç " class="user-submit" tabindex="1002" /> <input type="hidden" name="redirect_to" value="/clsn/lx429.html?reset=true" /> <input type="hidden" name="user-cookie" value="1" /> </div> </form> </div> </div> </div> </div> </div><ul id="scroll"> <li class="log log-no"><a class="log-button" title="æ–‡ç« ç›®å½•"><i class="be be-menu"></i></a><div class="log-prompt"><div class="log-arrow">æ–‡ç« ç›®å½•</div></div></li> <li><a class="scroll-home" href="index.htm" tppabs="http://clsn.io/" title="é¦–é¡µ" rel="home"><i class="be be-home"></i></a></li> <li><a class="scroll-h" title="è¿”å›é¡¶éƒ¨"><i class="be be-arrowup"></i></a></li> <li><a class="scroll-c" title="è¯„è®º"><i class="be be-speechbubble"></i></a></li> <li><a class="scroll-b" title="è½¬åˆ°åº•éƒ¨"><i class="be be-arrowdown"></i></a></li> <li class="qr-site"><a href="javascript:void(0)" class="qr" title="æœ¬é¡µäºŒç»´ç "><i class="be be-qr-code"></i><span class="qr-img"><span id="output"><img class="alignnone" src="Frog-2-1.png" tppabs="http://clsn.io/wp-content/uploads/2018/09/Frog-2-1.png" alt="icon"/></span><span class="arrow arrow-z"><i class="be be-playarrow"></i></span><span class="arrow arrow-y"><i class="be be-playarrow"></i></span></span></a></li> <script type="text/javascript">$(document).ready(function(){if(!+[1,]){present="table";} else {present="canvas";}$('#output').qrcode({render:present,text:window.location.href,width:"150",height:"150"});});</script> </ul> <script src="wb.js" tppabs="http://tjs.sjs.sinajs.cn/open/api/js/wb.js" type="text/javascript" charset="utf-8"></script> <html xmlns:wb="http://open.weibo.com/wb"></div><!-- .site --><script type="text/javascript">/* é¼ æ ‡ç‚¹å‡»ç‰¹æ•ˆ */var a_idx = 0;jQuery(document).ready(function($) { $("body").click(function(e) {//var a = new Array("å¯Œå¼º", "æ°‘ä¸»", "æ–‡æ˜", "å’Œè°", "è‡ªç”±", "å¹³ç­‰", "å…¬æ­£" ,"æ³•æ²»", "çˆ±å›½", "æ•¬ä¸š", "è¯šä¿¡", "å‹å–„");var a = new Array("clsn", "æƒ¨ç»¿å°‘å¹´", "CLSN", "clsn.io", "linux", "", "å…¬æ­£");var $i = $("<span/>").text(a[a_idx]); a_idx = (a_idx + 1) % a.length;var x = e.pageX, y = e.pageY; $i.css({"z-index": 999999999999999999999999999999999999999999999999999999999999999999999,"top": y - 20,"left": x,"position": "absolute","font-weight": "bold","color": "#ff6651" }); $("body").append($i); $i.animate({"top": y - 180,"opacity": 0 }, 1500,function() { $i.remove(); }); });});</script><script type="text/javascript" src="jquery-ui.min.js" tppabs="http://clsn.io/wp-content/themes/clsn-003/js/jquery-ui.min.js"></script><script type="text/javascript" src="qaptcha.jquery.js" tppabs="http://clsn.io/wp-content/themes/clsn-003/js/qaptcha.jquery.js"></script><script type="text/javascript">var QaptchaJqueryPage="/wp-content/themes/clsn-003/inc/qaptcha.jquery.php"</script><script type="text/javascript">$(document).ready(function(){$('.qaptcha').QapTcha();});</script><script type='text/javascript'>/* <![CDATA[ */var imp_data = {"ajaxurl":"http:\/\/clsn.io\/wp-admin\/admin-ajax.php","_wpnonce":"848a4b7a78"};/* ]]> */</script><script type='text/javascript' src="import.js-ver=4.9.8" tppabs="http://clsn.io/wp-content/plugins/cnblogs2wp/js/import.js?ver=4.9.8"></script><script type='text/javascript' src="slides.js-ver=2017.07.26" tppabs="http://clsn.io/wp-content/themes/clsn-003/js/slides.js?ver=2017.07.26"></script><script type='text/javascript' src="jquery.qrcode.min.js-ver=2017.07.26" tppabs="http://clsn.io/wp-content/themes/clsn-003/js/jquery.qrcode.min.js?ver=2017.07.26"></script><script type='text/javascript' src="sticky.js-ver=1.6.0" tppabs="http://clsn.io/wp-content/themes/clsn-003/js/sticky.js?ver=1.6.0"></script><script type='text/javascript' src="jquery-ias.js-ver=2.2.1" tppabs="http://clsn.io/wp-content/themes/clsn-003/js/jquery-ias.js?ver=2.2.1"></script><script type='text/javascript' src="jquery.lazyload.js-ver=2017.07.26" tppabs="http://clsn.io/wp-content/themes/clsn-003/js/jquery.lazyload.js?ver=2017.07.26"></script><script type='text/javascript' src="tipso.js-ver=1.0.1" tppabs="http://clsn.io/wp-content/themes/clsn-003/js/tipso.js?ver=1.0.1"></script><script type='text/javascript'>/* <![CDATA[ */var wpl_ajax_url = "\/wp-content\/themes\/clsn-003\/inc\/admin-ajax.php";/* ]]> */</script><script type='text/javascript' src="script.js-ver=2017.07.26" tppabs="http://clsn.io/wp-content/themes/clsn-003/js/script.js?ver=2017.07.26"></script><script type='text/javascript' src="flexisel.js-ver=2017.07.26" tppabs="http://clsn.io/wp-content/themes/clsn-003/js/flexisel.js?ver=2017.07.26"></script><script type='text/javascript' src="fancybox.js-ver=2017.07.26" tppabs="http://clsn.io/wp-content/themes/clsn-003/js/fancybox.js?ver=2017.07.26"></script><script type='text/javascript' src="comments-ajax-qt.js-ver=2017.07.26" tppabs="http://clsn.io/wp-content/themes/clsn-003/js/comments-ajax-qt.js?ver=2017.07.26"></script><script type='text/javascript' src="superfish.js-ver=2017.07.26" tppabs="http://clsn.io/wp-content/themes/clsn-003/js/superfish.js?ver=2017.07.26"></script><script type='text/javascript' src="bd-share.js-ver=2017.07.26" tppabs="http://clsn.io/wp-content/themes/clsn-003/js/bd-share.js?ver=2017.07.26"></script><script type='text/javascript' src="wpzm.js-ver=2017.07.26" tppabs="http://clsn.io/wp-content/themes/clsn-003/js/wpzm.js?ver=2017.07.26"></script><script type="text/javascript">var ias=$.ias({container:"#comments",item:".comment-list",pagination:".scroll-links",next:".scroll-links .nav-previous a",});ias.extension(new IASTriggerExtension({text:'<i class="be be-circledown"></i>æ›´å¤š',offset: 0,}));ias.extension(new IASSpinnerExtension());ias.extension(new IASNoneLeftExtension({text:'å·²æ˜¯æœ€å',}));ias.on('rendered',function(items){$("img").lazyload({effect: "fadeIn",failure_limit: 10});});</script></body></html>